<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ratio Estimators • tidycreel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script>/**
 * @popperjs/core v2.11.7 - MIT License
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Popper={})}(this,(function(e){"use strict";function t(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function n(e){return e instanceof t(e).Element||e instanceof Element}function r(e){return e instanceof t(e).HTMLElement||e instanceof HTMLElement}function o(e){return"undefined"!=typeof ShadowRoot&&(e instanceof t(e).ShadowRoot||e instanceof ShadowRoot)}var i=Math.max,a=Math.min,s=Math.round;function f(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function c(){return!/^((?!chrome|android).)*safari/i.test(f())}function p(e,o,i){void 0===o&&(o=!1),void 0===i&&(i=!1);var a=e.getBoundingClientRect(),f=1,p=1;o&&r(e)&&(f=e.offsetWidth>0&&s(a.width)/e.offsetWidth||1,p=e.offsetHeight>0&&s(a.height)/e.offsetHeight||1);var u=(n(e)?t(e):window).visualViewport,l=!c()&&i,d=(a.left+(l&&u?u.offsetLeft:0))/f,h=(a.top+(l&&u?u.offsetTop:0))/p,m=a.width/f,v=a.height/p;return{width:m,height:v,top:h,right:d+m,bottom:h+v,left:d,x:d,y:h}}function u(e){var n=t(e);return{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function l(e){return e?(e.nodeName||"").toLowerCase():null}function d(e){return((n(e)?e.ownerDocument:e.document)||window.document).documentElement}function h(e){return p(d(e)).left+u(e).scrollLeft}function m(e){return t(e).getComputedStyle(e)}function v(e){var t=m(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function y(e,n,o){void 0===o&&(o=!1);var i,a,f=r(n),c=r(n)&&function(e){var t=e.getBoundingClientRect(),n=s(t.width)/e.offsetWidth||1,r=s(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(n),m=d(n),y=p(e,c,o),g={scrollLeft:0,scrollTop:0},b={x:0,y:0};return(f||!f&&!o)&&(("body"!==l(n)||v(m))&&(g=(i=n)!==t(i)&&r(i)?{scrollLeft:(a=i).scrollLeft,scrollTop:a.scrollTop}:u(i)),r(n)?((b=p(n,!0)).x+=n.clientLeft,b.y+=n.clientTop):m&&(b.x=h(m))),{x:y.left+g.scrollLeft-b.x,y:y.top+g.scrollTop-b.y,width:y.width,height:y.height}}function g(e){var t=p(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function b(e){return"html"===l(e)?e:e.assignedSlot||e.parentNode||(o(e)?e.host:null)||d(e)}function x(e){return["html","body","#document"].indexOf(l(e))>=0?e.ownerDocument.body:r(e)&&v(e)?e:x(b(e))}function w(e,n){var r;void 0===n&&(n=[]);var o=x(e),i=o===(null==(r=e.ownerDocument)?void 0:r.body),a=t(o),s=i?[a].concat(a.visualViewport||[],v(o)?o:[]):o,f=n.concat(s);return i?f:f.concat(w(b(s)))}function O(e){return["table","td","th"].indexOf(l(e))>=0}function j(e){return r(e)&&"fixed"!==m(e).position?e.offsetParent:null}function E(e){for(var n=t(e),i=j(e);i&&O(i)&&"static"===m(i).position;)i=j(i);return i&&("html"===l(i)||"body"===l(i)&&"static"===m(i).position)?n:i||function(e){var t=/firefox/i.test(f());if(/Trident/i.test(f())&&r(e)&&"fixed"===m(e).position)return null;var n=b(e);for(o(n)&&(n=n.host);r(n)&&["html","body"].indexOf(l(n))<0;){var i=m(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||n}var D="top",A="bottom",L="right",P="left",M="auto",k=[D,A,L,P],W="start",B="end",H="viewport",T="popper",R=k.reduce((function(e,t){return e.concat([t+"-"+W,t+"-"+B])}),[]),S=[].concat(k,[M]).reduce((function(e,t){return e.concat([t,t+"-"+W,t+"-"+B])}),[]),V=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function q(e){var t=new Map,n=new Set,r=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&o(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),r}function C(e){return e.split("-")[0]}function N(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&o(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function I(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function _(e,r,o){return r===H?I(function(e,n){var r=t(e),o=d(e),i=r.visualViewport,a=o.clientWidth,s=o.clientHeight,f=0,p=0;if(i){a=i.width,s=i.height;var u=c();(u||!u&&"fixed"===n)&&(f=i.offsetLeft,p=i.offsetTop)}return{width:a,height:s,x:f+h(e),y:p}}(e,o)):n(r)?function(e,t){var n=p(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(r,o):I(function(e){var t,n=d(e),r=u(e),o=null==(t=e.ownerDocument)?void 0:t.body,a=i(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),s=i(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),f=-r.scrollLeft+h(e),c=-r.scrollTop;return"rtl"===m(o||n).direction&&(f+=i(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:s,x:f,y:c}}(d(e)))}function F(e,t,o,s){var f="clippingParents"===t?function(e){var t=w(b(e)),o=["absolute","fixed"].indexOf(m(e).position)>=0&&r(e)?E(e):e;return n(o)?t.filter((function(e){return n(e)&&N(e,o)&&"body"!==l(e)})):[]}(e):[].concat(t),c=[].concat(f,[o]),p=c[0],u=c.reduce((function(t,n){var r=_(e,n,s);return t.top=i(r.top,t.top),t.right=a(r.right,t.right),t.bottom=a(r.bottom,t.bottom),t.left=i(r.left,t.left),t}),_(e,p,s));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function U(e){return e.split("-")[1]}function z(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function X(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?C(o):null,a=o?U(o):null,s=n.x+n.width/2-r.width/2,f=n.y+n.height/2-r.height/2;switch(i){case D:t={x:s,y:n.y-r.height};break;case A:t={x:s,y:n.y+n.height};break;case L:t={x:n.x+n.width,y:f};break;case P:t={x:n.x-r.width,y:f};break;default:t={x:n.x,y:n.y}}var c=i?z(i):null;if(null!=c){var p="y"===c?"height":"width";switch(a){case W:t[c]=t[c]-(n[p]/2-r[p]/2);break;case B:t[c]=t[c]+(n[p]/2-r[p]/2)}}return t}function Y(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function G(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function J(e,t){void 0===t&&(t={});var r=t,o=r.placement,i=void 0===o?e.placement:o,a=r.strategy,s=void 0===a?e.strategy:a,f=r.boundary,c=void 0===f?"clippingParents":f,u=r.rootBoundary,l=void 0===u?H:u,h=r.elementContext,m=void 0===h?T:h,v=r.altBoundary,y=void 0!==v&&v,g=r.padding,b=void 0===g?0:g,x=Y("number"!=typeof b?b:G(b,k)),w=m===T?"reference":T,O=e.rects.popper,j=e.elements[y?w:m],E=F(n(j)?j:j.contextElement||d(e.elements.popper),c,l,s),P=p(e.elements.reference),M=X({reference:P,element:O,strategy:"absolute",placement:i}),W=I(Object.assign({},O,M)),B=m===T?W:P,R={top:E.top-B.top+x.top,bottom:B.bottom-E.bottom+x.bottom,left:E.left-B.left+x.left,right:B.right-E.right+x.right},S=e.modifiersData.offset;if(m===T&&S){var V=S[i];Object.keys(R).forEach((function(e){var t=[L,A].indexOf(e)>=0?1:-1,n=[D,A].indexOf(e)>=0?"y":"x";R[e]+=V[n]*t}))}return R}var K={placement:"bottom",modifiers:[],strategy:"absolute"};function Q(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Z(e){void 0===e&&(e={});var t=e,r=t.defaultModifiers,o=void 0===r?[]:r,i=t.defaultOptions,a=void 0===i?K:i;return function(e,t,r){void 0===r&&(r=a);var i,s,f={placement:"bottom",orderedModifiers:[],options:Object.assign({},K,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],p=!1,u={state:f,setOptions:function(r){var i="function"==typeof r?r(f.options):r;l(),f.options=Object.assign({},a,f.options,i),f.scrollParents={reference:n(e)?w(e):e.contextElement?w(e.contextElement):[],popper:w(t)};var s,p,d=function(e){var t=q(e);return V.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((s=[].concat(o,f.options.modifiers),p=s.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(p).map((function(e){return p[e]}))));return f.orderedModifiers=d.filter((function(e){return e.enabled})),f.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:f,name:t,instance:u,options:r}),a=function(){};c.push(i||a)}})),u.update()},forceUpdate:function(){if(!p){var e=f.elements,t=e.reference,n=e.popper;if(Q(t,n)){f.rects={reference:y(t,E(n),"fixed"===f.options.strategy),popper:g(n)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach((function(e){return f.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<f.orderedModifiers.length;r++)if(!0!==f.reset){var o=f.orderedModifiers[r],i=o.fn,a=o.options,s=void 0===a?{}:a,c=o.name;"function"==typeof i&&(f=i({state:f,options:s,name:c,instance:u})||f)}else f.reset=!1,r=-1}}},update:(i=function(){return new Promise((function(e){u.forceUpdate(),e(f)}))},function(){return s||(s=new Promise((function(e){Promise.resolve().then((function(){s=void 0,e(i())}))}))),s}),destroy:function(){l(),p=!0}};if(!Q(e,t))return u;function l(){c.forEach((function(e){return e()})),c=[]}return u.setOptions(r).then((function(e){!p&&r.onFirstUpdate&&r.onFirstUpdate(e)})),u}}var $={passive:!0};var ee={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var n=e.state,r=e.instance,o=e.options,i=o.scroll,a=void 0===i||i,s=o.resize,f=void 0===s||s,c=t(n.elements.popper),p=[].concat(n.scrollParents.reference,n.scrollParents.popper);return a&&p.forEach((function(e){e.addEventListener("scroll",r.update,$)})),f&&c.addEventListener("resize",r.update,$),function(){a&&p.forEach((function(e){e.removeEventListener("scroll",r.update,$)})),f&&c.removeEventListener("resize",r.update,$)}},data:{}};var te={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=X({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},ne={top:"auto",right:"auto",bottom:"auto",left:"auto"};function re(e){var n,r=e.popper,o=e.popperRect,i=e.placement,a=e.variation,f=e.offsets,c=e.position,p=e.gpuAcceleration,u=e.adaptive,l=e.roundOffsets,h=e.isFixed,v=f.x,y=void 0===v?0:v,g=f.y,b=void 0===g?0:g,x="function"==typeof l?l({x:y,y:b}):{x:y,y:b};y=x.x,b=x.y;var w=f.hasOwnProperty("x"),O=f.hasOwnProperty("y"),j=P,M=D,k=window;if(u){var W=E(r),H="clientHeight",T="clientWidth";if(W===t(r)&&"static"!==m(W=d(r)).position&&"absolute"===c&&(H="scrollHeight",T="scrollWidth"),W=W,i===D||(i===P||i===L)&&a===B)M=A,b-=(h&&W===k&&k.visualViewport?k.visualViewport.height:W[H])-o.height,b*=p?1:-1;if(i===P||(i===D||i===A)&&a===B)j=L,y-=(h&&W===k&&k.visualViewport?k.visualViewport.width:W[T])-o.width,y*=p?1:-1}var R,S=Object.assign({position:c},u&&ne),V=!0===l?function(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:s(n*o)/o||0,y:s(r*o)/o||0}}({x:y,y:b},t(r)):{x:y,y:b};return y=V.x,b=V.y,p?Object.assign({},S,((R={})[M]=O?"0":"",R[j]=w?"0":"",R.transform=(k.devicePixelRatio||1)<=1?"translate("+y+"px, "+b+"px)":"translate3d("+y+"px, "+b+"px, 0)",R)):Object.assign({},S,((n={})[M]=O?b+"px":"",n[j]=w?y+"px":"",n.transform="",n))}var oe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,f=void 0===s||s,c={placement:C(t.placement),variation:U(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,re(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:f})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,re(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var ie={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},o=t.attributes[e]||{},i=t.elements[e];r(i)&&l(i)&&(Object.assign(i.style,n),Object.keys(o).forEach((function(e){var t=o[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var o=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});r(o)&&l(o)&&(Object.assign(o.style,a),Object.keys(i).forEach((function(e){o.removeAttribute(e)})))}))}},requires:["computeStyles"]};var ae={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=S.reduce((function(e,n){return e[n]=function(e,t,n){var r=C(e),o=[P,D].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[P,L].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,i),e}),{}),s=a[t.placement],f=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=f,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=a}},se={left:"right",right:"left",bottom:"top",top:"bottom"};function fe(e){return e.replace(/left|right|bottom|top/g,(function(e){return se[e]}))}var ce={start:"end",end:"start"};function pe(e){return e.replace(/start|end/g,(function(e){return ce[e]}))}function ue(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,f=n.allowedAutoPlacements,c=void 0===f?S:f,p=U(r),u=p?s?R:R.filter((function(e){return U(e)===p})):k,l=u.filter((function(e){return c.indexOf(e)>=0}));0===l.length&&(l=u);var d=l.reduce((function(t,n){return t[n]=J(e,{placement:n,boundary:o,rootBoundary:i,padding:a})[C(n)],t}),{});return Object.keys(d).sort((function(e,t){return d[e]-d[t]}))}var le={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,f=n.fallbackPlacements,c=n.padding,p=n.boundary,u=n.rootBoundary,l=n.altBoundary,d=n.flipVariations,h=void 0===d||d,m=n.allowedAutoPlacements,v=t.options.placement,y=C(v),g=f||(y===v||!h?[fe(v)]:function(e){if(C(e)===M)return[];var t=fe(e);return[pe(e),t,pe(t)]}(v)),b=[v].concat(g).reduce((function(e,n){return e.concat(C(n)===M?ue(t,{placement:n,boundary:p,rootBoundary:u,padding:c,flipVariations:h,allowedAutoPlacements:m}):n)}),[]),x=t.rects.reference,w=t.rects.popper,O=new Map,j=!0,E=b[0],k=0;k<b.length;k++){var B=b[k],H=C(B),T=U(B)===W,R=[D,A].indexOf(H)>=0,S=R?"width":"height",V=J(t,{placement:B,boundary:p,rootBoundary:u,altBoundary:l,padding:c}),q=R?T?L:P:T?A:D;x[S]>w[S]&&(q=fe(q));var N=fe(q),I=[];if(i&&I.push(V[H]<=0),s&&I.push(V[q]<=0,V[N]<=0),I.every((function(e){return e}))){E=B,j=!1;break}O.set(B,I)}if(j)for(var _=function(e){var t=b.find((function(t){var n=O.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return E=t,"break"},F=h?3:1;F>0;F--){if("break"===_(F))break}t.placement!==E&&(t.modifiersData[r]._skip=!0,t.placement=E,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function de(e,t,n){return i(e,a(t,n))}var he={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,s=void 0===o||o,f=n.altAxis,c=void 0!==f&&f,p=n.boundary,u=n.rootBoundary,l=n.altBoundary,d=n.padding,h=n.tether,m=void 0===h||h,v=n.tetherOffset,y=void 0===v?0:v,b=J(t,{boundary:p,rootBoundary:u,padding:d,altBoundary:l}),x=C(t.placement),w=U(t.placement),O=!w,j=z(x),M="x"===j?"y":"x",k=t.modifiersData.popperOffsets,B=t.rects.reference,H=t.rects.popper,T="function"==typeof y?y(Object.assign({},t.rects,{placement:t.placement})):y,R="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),S=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,V={x:0,y:0};if(k){if(s){var q,N="y"===j?D:P,I="y"===j?A:L,_="y"===j?"height":"width",F=k[j],X=F+b[N],Y=F-b[I],G=m?-H[_]/2:0,K=w===W?B[_]:H[_],Q=w===W?-H[_]:-B[_],Z=t.elements.arrow,$=m&&Z?g(Z):{width:0,height:0},ee=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},te=ee[N],ne=ee[I],re=de(0,B[_],$[_]),oe=O?B[_]/2-G-re-te-R.mainAxis:K-re-te-R.mainAxis,ie=O?-B[_]/2+G+re+ne+R.mainAxis:Q+re+ne+R.mainAxis,ae=t.elements.arrow&&E(t.elements.arrow),se=ae?"y"===j?ae.clientTop||0:ae.clientLeft||0:0,fe=null!=(q=null==S?void 0:S[j])?q:0,ce=F+ie-fe,pe=de(m?a(X,F+oe-fe-se):X,F,m?i(Y,ce):Y);k[j]=pe,V[j]=pe-F}if(c){var ue,le="x"===j?D:P,he="x"===j?A:L,me=k[M],ve="y"===M?"height":"width",ye=me+b[le],ge=me-b[he],be=-1!==[D,P].indexOf(x),xe=null!=(ue=null==S?void 0:S[M])?ue:0,we=be?ye:me-B[ve]-H[ve]-xe+R.altAxis,Oe=be?me+B[ve]+H[ve]-xe-R.altAxis:ge,je=m&&be?function(e,t,n){var r=de(e,t,n);return r>n?n:r}(we,me,Oe):de(m?we:ye,me,m?Oe:ge);k[M]=je,V[M]=je-me}t.modifiersData[r]=V}},requiresIfExists:["offset"]};var me={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=C(n.placement),f=z(s),c=[P,L].indexOf(s)>=0?"height":"width";if(i&&a){var p=function(e,t){return Y("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:G(e,k))}(o.padding,n),u=g(i),l="y"===f?D:P,d="y"===f?A:L,h=n.rects.reference[c]+n.rects.reference[f]-a[f]-n.rects.popper[c],m=a[f]-n.rects.reference[f],v=E(i),y=v?"y"===f?v.clientHeight||0:v.clientWidth||0:0,b=h/2-m/2,x=p[l],w=y-u[c]-p[d],O=y/2-u[c]/2+b,j=de(x,O,w),M=f;n.modifiersData[r]=((t={})[M]=j,t.centerOffset=j-O,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&N(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ve(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function ye(e){return[D,L,A,P].some((function(t){return e[t]>=0}))}var ge={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=J(t,{elementContext:"reference"}),s=J(t,{altBoundary:!0}),f=ve(a,r),c=ve(s,o,i),p=ye(f),u=ye(c);t.modifiersData[n]={referenceClippingOffsets:f,popperEscapeOffsets:c,isReferenceHidden:p,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":u})}},be=Z({defaultModifiers:[ee,te,oe,ie]}),xe=[ee,te,oe,ie,ae,le,he,me,ge],we=Z({defaultModifiers:xe});e.applyStyles=ie,e.arrow=me,e.computeStyles=oe,e.createPopper=we,e.createPopperLite=be,e.defaultModifiers=xe,e.detectOverflow=J,e.eventListeners=ee,e.flip=le,e.hide=ge,e.offset=ae,e.popperGenerator=Z,e.popperOffsets=te,e.preventOverflow=he,Object.defineProperty(e,"__esModule",{value:!0})}));

</script><script>!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],t):(e=e||self).tippy=t(e.Popper)}(this,(function(e){"use strict";var t={passive:!0,capture:!0},n=function(){return document.body};function r(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function o(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function i(e,t){return"function"==typeof e?e.apply(void 0,t):e}function a(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)};var n}function s(e,t){var n=Object.assign({},e);return t.forEach((function(e){delete n[e]})),n}function u(e){return[].concat(e)}function c(e,t){-1===e.indexOf(t)&&e.push(t)}function p(e){return e.split("-")[0]}function f(e){return[].slice.call(e)}function l(e){return Object.keys(e).reduce((function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t}),{})}function d(){return document.createElement("div")}function v(e){return["Element","Fragment"].some((function(t){return o(e,t)}))}function m(e){return o(e,"MouseEvent")}function g(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function h(e){return v(e)?[e]:function(e){return o(e,"NodeList")}(e)?f(e):Array.isArray(e)?e:f(document.querySelectorAll(e))}function b(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function y(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function w(e){var t,n=u(e)[0];return null!=n&&null!=(t=n.ownerDocument)&&t.body?n.ownerDocument:document}function E(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[r](t,n)}))}function O(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var x={isTouch:!1},C=0;function T(){x.isTouch||(x.isTouch=!0,window.performance&&document.addEventListener("mousemove",A))}function A(){var e=performance.now();e-C<20&&(x.isTouch=!1,document.removeEventListener("mousemove",A)),C=e}function L(){var e=document.activeElement;if(g(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var D=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto,R=Object.assign({appendTo:n,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),k=Object.keys(R);function P(e){var t=(e.plugins||[]).reduce((function(t,n){var r,o=n.name,i=n.defaultValue;o&&(t[o]=void 0!==e[o]?e[o]:null!=(r=R[o])?r:i);return t}),{});return Object.assign({},e,t)}function j(e,t){var n=Object.assign({},t,{content:i(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(P(Object.assign({},R,{plugins:t}))):k).reduce((function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t}),{})}(e,t.plugins));return n.aria=Object.assign({},R.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function M(e,t){e.innerHTML=t}function V(e){var t=d();return!0===e?t.className="tippy-arrow":(t.className="tippy-svg-arrow",v(e)?t.appendChild(e):M(t,e)),t}function I(e,t){v(t.content)?(M(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?M(e,t.content):e.textContent=t.content)}function S(e){var t=e.firstElementChild,n=f(t.children);return{box:t,content:n.find((function(e){return e.classList.contains("tippy-content")})),arrow:n.find((function(e){return e.classList.contains("tippy-arrow")||e.classList.contains("tippy-svg-arrow")})),backdrop:n.find((function(e){return e.classList.contains("tippy-backdrop")}))}}function N(e){var t=d(),n=d();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=d();function o(n,r){var o=S(t),i=o.box,a=o.content,s=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||I(a,e.props),r.arrow?s?n.arrow!==r.arrow&&(i.removeChild(s),i.appendChild(V(r.arrow))):i.appendChild(V(r.arrow)):s&&i.removeChild(s)}return r.className="tippy-content",r.setAttribute("data-state","hidden"),I(r,e.props),t.appendChild(n),n.appendChild(r),o(e.props,e.props),{popper:t,onUpdate:o}}N.$$tippy=!0;var B=1,H=[],U=[];function _(o,s){var v,g,h,C,T,A,L,k,M=j(o,Object.assign({},R,P(l(s)))),V=!1,I=!1,N=!1,_=!1,F=[],W=a(we,M.interactiveDebounce),X=B++,Y=(k=M.plugins).filter((function(e,t){return k.indexOf(e)===t})),$={id:X,reference:o,popper:d(),popperInstance:null,props:M,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:Y,clearDelayTimeouts:function(){clearTimeout(v),clearTimeout(g),cancelAnimationFrame(h)},setProps:function(e){if($.state.isDestroyed)return;ae("onBeforeUpdate",[$,e]),be();var t=$.props,n=j(o,Object.assign({},t,l(e),{ignoreAttributes:!0}));$.props=n,he(),t.interactiveDebounce!==n.interactiveDebounce&&(ce(),W=a(we,n.interactiveDebounce));t.triggerTarget&&!n.triggerTarget?u(t.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):n.triggerTarget&&o.removeAttribute("aria-expanded");ue(),ie(),J&&J(t,n);$.popperInstance&&(Ce(),Ae().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));ae("onAfterUpdate",[$,e])},setContent:function(e){$.setProps({content:e})},show:function(){var e=$.state.isVisible,t=$.state.isDestroyed,o=!$.state.isEnabled,a=x.isTouch&&!$.props.touch,s=r($.props.duration,0,R.duration);if(e||t||o||a)return;if(te().hasAttribute("disabled"))return;if(ae("onShow",[$],!1),!1===$.props.onShow($))return;$.state.isVisible=!0,ee()&&(z.style.visibility="visible");ie(),de(),$.state.isMounted||(z.style.transition="none");if(ee()){var u=re(),p=u.box,f=u.content;b([p,f],0)}A=function(){var e;if($.state.isVisible&&!_){if(_=!0,z.offsetHeight,z.style.transition=$.props.moveTransition,ee()&&$.props.animation){var t=re(),n=t.box,r=t.content;b([n,r],s),y([n,r],"visible")}se(),ue(),c(U,$),null==(e=$.popperInstance)||e.forceUpdate(),ae("onMount",[$]),$.props.animation&&ee()&&function(e,t){me(e,t)}(s,(function(){$.state.isShown=!0,ae("onShown",[$])}))}},function(){var e,t=$.props.appendTo,r=te();e=$.props.interactive&&t===n||"parent"===t?r.parentNode:i(t,[r]);e.contains(z)||e.appendChild(z);$.state.isMounted=!0,Ce()}()},hide:function(){var e=!$.state.isVisible,t=$.state.isDestroyed,n=!$.state.isEnabled,o=r($.props.duration,1,R.duration);if(e||t||n)return;if(ae("onHide",[$],!1),!1===$.props.onHide($))return;$.state.isVisible=!1,$.state.isShown=!1,_=!1,V=!1,ee()&&(z.style.visibility="hidden");if(ce(),ve(),ie(!0),ee()){var i=re(),a=i.box,s=i.content;$.props.animation&&(b([a,s],o),y([a,s],"hidden"))}se(),ue(),$.props.animation?ee()&&function(e,t){me(e,(function(){!$.state.isVisible&&z.parentNode&&z.parentNode.contains(z)&&t()}))}(o,$.unmount):$.unmount()},hideWithInteractivity:function(e){ne().addEventListener("mousemove",W),c(H,W),W(e)},enable:function(){$.state.isEnabled=!0},disable:function(){$.hide(),$.state.isEnabled=!1},unmount:function(){$.state.isVisible&&$.hide();if(!$.state.isMounted)return;Te(),Ae().forEach((function(e){e._tippy.unmount()})),z.parentNode&&z.parentNode.removeChild(z);U=U.filter((function(e){return e!==$})),$.state.isMounted=!1,ae("onHidden",[$])},destroy:function(){if($.state.isDestroyed)return;$.clearDelayTimeouts(),$.unmount(),be(),delete o._tippy,$.state.isDestroyed=!0,ae("onDestroy",[$])}};if(!M.render)return $;var q=M.render($),z=q.popper,J=q.onUpdate;z.setAttribute("data-tippy-root",""),z.id="tippy-"+$.id,$.popper=z,o._tippy=$,z._tippy=$;var G=Y.map((function(e){return e.fn($)})),K=o.hasAttribute("aria-expanded");return he(),ue(),ie(),ae("onCreate",[$]),M.showOnCreate&&Le(),z.addEventListener("mouseenter",(function(){$.props.interactive&&$.state.isVisible&&$.clearDelayTimeouts()})),z.addEventListener("mouseleave",(function(){$.props.interactive&&$.props.trigger.indexOf("mouseenter")>=0&&ne().addEventListener("mousemove",W)})),$;function Q(){var e=$.props.touch;return Array.isArray(e)?e:[e,0]}function Z(){return"hold"===Q()[0]}function ee(){var e;return!(null==(e=$.props.render)||!e.$$tippy)}function te(){return L||o}function ne(){var e=te().parentNode;return e?w(e):document}function re(){return S(z)}function oe(e){return $.state.isMounted&&!$.state.isVisible||x.isTouch||C&&"focus"===C.type?0:r($.props.delay,e?0:1,R.delay)}function ie(e){void 0===e&&(e=!1),z.style.pointerEvents=$.props.interactive&&!e?"":"none",z.style.zIndex=""+$.props.zIndex}function ae(e,t,n){var r;(void 0===n&&(n=!0),G.forEach((function(n){n[e]&&n[e].apply(n,t)})),n)&&(r=$.props)[e].apply(r,t)}function se(){var e=$.props.aria;if(e.content){var t="aria-"+e.content,n=z.id;u($.props.triggerTarget||o).forEach((function(e){var r=e.getAttribute(t);if($.state.isVisible)e.setAttribute(t,r?r+" "+n:n);else{var o=r&&r.replace(n,"").trim();o?e.setAttribute(t,o):e.removeAttribute(t)}}))}}function ue(){!K&&$.props.aria.expanded&&u($.props.triggerTarget||o).forEach((function(e){$.props.interactive?e.setAttribute("aria-expanded",$.state.isVisible&&e===te()?"true":"false"):e.removeAttribute("aria-expanded")}))}function ce(){ne().removeEventListener("mousemove",W),H=H.filter((function(e){return e!==W}))}function pe(e){if(!x.isTouch||!N&&"mousedown"!==e.type){var t=e.composedPath&&e.composedPath()[0]||e.target;if(!$.props.interactive||!O(z,t)){if(u($.props.triggerTarget||o).some((function(e){return O(e,t)}))){if(x.isTouch)return;if($.state.isVisible&&$.props.trigger.indexOf("click")>=0)return}else ae("onClickOutside",[$,e]);!0===$.props.hideOnClick&&($.clearDelayTimeouts(),$.hide(),I=!0,setTimeout((function(){I=!1})),$.state.isMounted||ve())}}}function fe(){N=!0}function le(){N=!1}function de(){var e=ne();e.addEventListener("mousedown",pe,!0),e.addEventListener("touchend",pe,t),e.addEventListener("touchstart",le,t),e.addEventListener("touchmove",fe,t)}function ve(){var e=ne();e.removeEventListener("mousedown",pe,!0),e.removeEventListener("touchend",pe,t),e.removeEventListener("touchstart",le,t),e.removeEventListener("touchmove",fe,t)}function me(e,t){var n=re().box;function r(e){e.target===n&&(E(n,"remove",r),t())}if(0===e)return t();E(n,"remove",T),E(n,"add",r),T=r}function ge(e,t,n){void 0===n&&(n=!1),u($.props.triggerTarget||o).forEach((function(r){r.addEventListener(e,t,n),F.push({node:r,eventType:e,handler:t,options:n})}))}function he(){var e;Z()&&(ge("touchstart",ye,{passive:!0}),ge("touchend",Ee,{passive:!0})),(e=$.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(ge(e,ye),e){case"mouseenter":ge("mouseleave",Ee);break;case"focus":ge(D?"focusout":"blur",Oe);break;case"focusin":ge("focusout",Oe)}}))}function be(){F.forEach((function(e){var t=e.node,n=e.eventType,r=e.handler,o=e.options;t.removeEventListener(n,r,o)})),F=[]}function ye(e){var t,n=!1;if($.state.isEnabled&&!xe(e)&&!I){var r="focus"===(null==(t=C)?void 0:t.type);C=e,L=e.currentTarget,ue(),!$.state.isVisible&&m(e)&&H.forEach((function(t){return t(e)})),"click"===e.type&&($.props.trigger.indexOf("mouseenter")<0||V)&&!1!==$.props.hideOnClick&&$.state.isVisible?n=!0:Le(e),"click"===e.type&&(V=!n),n&&!r&&De(e)}}function we(e){var t=e.target,n=te().contains(t)||z.contains(t);"mousemove"===e.type&&n||function(e,t){var n=t.clientX,r=t.clientY;return e.every((function(e){var t=e.popperRect,o=e.popperState,i=e.props.interactiveBorder,a=p(o.placement),s=o.modifiersData.offset;if(!s)return!0;var u="bottom"===a?s.top.y:0,c="top"===a?s.bottom.y:0,f="right"===a?s.left.x:0,l="left"===a?s.right.x:0,d=t.top-r+u>i,v=r-t.bottom-c>i,m=t.left-n+f>i,g=n-t.right-l>i;return d||v||m||g}))}(Ae().concat(z).map((function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:M}:null})).filter(Boolean),e)&&(ce(),De(e))}function Ee(e){xe(e)||$.props.trigger.indexOf("click")>=0&&V||($.props.interactive?$.hideWithInteractivity(e):De(e))}function Oe(e){$.props.trigger.indexOf("focusin")<0&&e.target!==te()||$.props.interactive&&e.relatedTarget&&z.contains(e.relatedTarget)||De(e)}function xe(e){return!!x.isTouch&&Z()!==e.type.indexOf("touch")>=0}function Ce(){Te();var t=$.props,n=t.popperOptions,r=t.placement,i=t.offset,a=t.getReferenceClientRect,s=t.moveTransition,u=ee()?S(z).arrow:null,c=a?{getBoundingClientRect:a,contextElement:a.contextElement||te()}:o,p=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(ee()){var n=re().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)})),t.attributes.popper={}}}}];ee()&&u&&p.push({name:"arrow",options:{element:u,padding:3}}),p.push.apply(p,(null==n?void 0:n.modifiers)||[]),$.popperInstance=e.createPopper(c,z,Object.assign({},n,{placement:r,onFirstUpdate:A,modifiers:p}))}function Te(){$.popperInstance&&($.popperInstance.destroy(),$.popperInstance=null)}function Ae(){return f(z.querySelectorAll("[data-tippy-root]"))}function Le(e){$.clearDelayTimeouts(),e&&ae("onTrigger",[$,e]),de();var t=oe(!0),n=Q(),r=n[0],o=n[1];x.isTouch&&"hold"===r&&o&&(t=o),t?v=setTimeout((function(){$.show()}),t):$.show()}function De(e){if($.clearDelayTimeouts(),ae("onUntrigger",[$,e]),$.state.isVisible){if(!($.props.trigger.indexOf("mouseenter")>=0&&$.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&V)){var t=oe(!1);t?g=setTimeout((function(){$.state.isVisible&&$.hide()}),t):h=requestAnimationFrame((function(){$.hide()}))}}else ve()}}function F(e,n){void 0===n&&(n={});var r=R.plugins.concat(n.plugins||[]);document.addEventListener("touchstart",T,t),window.addEventListener("blur",L);var o=Object.assign({},n,{plugins:r}),i=h(e).reduce((function(e,t){var n=t&&_(t,o);return n&&e.push(n),e}),[]);return v(e)?i[0]:i}F.defaultProps=R,F.setDefaultProps=function(e){Object.keys(e).forEach((function(t){R[t]=e[t]}))},F.currentInput=x;var W=Object.assign({},e.applyStyles,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}}),X={mouseover:"mouseenter",focusin:"focus",click:"click"};var Y={name:"animateFill",defaultValue:!1,fn:function(e){var t;if(null==(t=e.props.render)||!t.$$tippy)return{};var n=S(e.popper),r=n.box,o=n.content,i=e.props.animateFill?function(){var e=d();return e.className="tippy-backdrop",y([e],"hidden"),e}():null;return{onCreate:function(){i&&(r.insertBefore(i,r.firstElementChild),r.setAttribute("data-animatefill",""),r.style.overflow="hidden",e.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){if(i){var e=r.style.transitionDuration,t=Number(e.replace("ms",""));o.style.transitionDelay=Math.round(t/10)+"ms",i.style.transitionDuration=e,y([i],"visible")}},onShow:function(){i&&(i.style.transitionDuration="0ms")},onHide:function(){i&&y([i],"hidden")}}}};var $={clientX:0,clientY:0},q=[];function z(e){var t=e.clientX,n=e.clientY;$={clientX:t,clientY:n}}var J={name:"followCursor",defaultValue:!1,fn:function(e){var t=e.reference,n=w(e.props.triggerTarget||t),r=!1,o=!1,i=!0,a=e.props;function s(){return"initial"===e.props.followCursor&&e.state.isVisible}function u(){n.addEventListener("mousemove",f)}function c(){n.removeEventListener("mousemove",f)}function p(){r=!0,e.setProps({getReferenceClientRect:null}),r=!1}function f(n){var r=!n.target||t.contains(n.target),o=e.props.followCursor,i=n.clientX,a=n.clientY,s=t.getBoundingClientRect(),u=i-s.left,c=a-s.top;!r&&e.props.interactive||e.setProps({getReferenceClientRect:function(){var e=t.getBoundingClientRect(),n=i,r=a;"initial"===o&&(n=e.left+u,r=e.top+c);var s="horizontal"===o?e.top:r,p="vertical"===o?e.right:n,f="horizontal"===o?e.bottom:r,l="vertical"===o?e.left:n;return{width:p-l,height:f-s,top:s,right:p,bottom:f,left:l}}})}function l(){e.props.followCursor&&(q.push({instance:e,doc:n}),function(e){e.addEventListener("mousemove",z)}(n))}function d(){0===(q=q.filter((function(t){return t.instance!==e}))).filter((function(e){return e.doc===n})).length&&function(e){e.removeEventListener("mousemove",z)}(n)}return{onCreate:l,onDestroy:d,onBeforeUpdate:function(){a=e.props},onAfterUpdate:function(t,n){var i=n.followCursor;r||void 0!==i&&a.followCursor!==i&&(d(),i?(l(),!e.state.isMounted||o||s()||u()):(c(),p()))},onMount:function(){e.props.followCursor&&!o&&(i&&(f($),i=!1),s()||u())},onTrigger:function(e,t){m(t)&&($={clientX:t.clientX,clientY:t.clientY}),o="focus"===t.type},onHidden:function(){e.props.followCursor&&(p(),c(),i=!0)}}}};var G={name:"inlinePositioning",defaultValue:!1,fn:function(e){var t,n=e.reference;var r=-1,o=!1,i=[],a={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(o){var a=o.state;e.props.inlinePositioning&&(-1!==i.indexOf(a.placement)&&(i=[]),t!==a.placement&&-1===i.indexOf(a.placement)&&(i.push(a.placement),e.setProps({getReferenceClientRect:function(){return function(e){return function(e,t,n,r){if(n.length<2||null===e)return t;if(2===n.length&&r>=0&&n[0].left>n[1].right)return n[r]||t;switch(e){case"top":case"bottom":var o=n[0],i=n[n.length-1],a="top"===e,s=o.top,u=i.bottom,c=a?o.left:i.left,p=a?o.right:i.right;return{top:s,bottom:u,left:c,right:p,width:p-c,height:u-s};case"left":case"right":var f=Math.min.apply(Math,n.map((function(e){return e.left}))),l=Math.max.apply(Math,n.map((function(e){return e.right}))),d=n.filter((function(t){return"left"===e?t.left===f:t.right===l})),v=d[0].top,m=d[d.length-1].bottom;return{top:v,bottom:m,left:f,right:l,width:l-f,height:m-v};default:return t}}(p(e),n.getBoundingClientRect(),f(n.getClientRects()),r)}(a.placement)}})),t=a.placement)}};function s(){var t;o||(t=function(e,t){var n;return{popperOptions:Object.assign({},e.popperOptions,{modifiers:[].concat(((null==(n=e.popperOptions)?void 0:n.modifiers)||[]).filter((function(e){return e.name!==t.name})),[t])})}}(e.props,a),o=!0,e.setProps(t),o=!1)}return{onCreate:s,onAfterUpdate:s,onTrigger:function(t,n){if(m(n)){var o=f(e.reference.getClientRects()),i=o.find((function(e){return e.left-2<=n.clientX&&e.right+2>=n.clientX&&e.top-2<=n.clientY&&e.bottom+2>=n.clientY})),a=o.indexOf(i);r=a>-1?a:r}},onHidden:function(){r=-1}}}};var K={name:"sticky",defaultValue:!1,fn:function(e){var t=e.reference,n=e.popper;function r(t){return!0===e.props.sticky||e.props.sticky===t}var o=null,i=null;function a(){var s=r("reference")?(e.popperInstance?e.popperInstance.state.elements.reference:t).getBoundingClientRect():null,u=r("popper")?n.getBoundingClientRect():null;(s&&Q(o,s)||u&&Q(i,u))&&e.popperInstance&&e.popperInstance.update(),o=s,i=u,e.state.isMounted&&requestAnimationFrame(a)}return{onMount:function(){e.props.sticky&&a()}}}};function Q(e,t){return!e||!t||(e.top!==t.top||e.right!==t.right||e.bottom!==t.bottom||e.left!==t.left)}return F.setDefaultProps({plugins:[Y,J,G,K],render:N}),F.createSingleton=function(e,t){var n;void 0===t&&(t={});var r,o=e,i=[],a=[],c=t.overrides,p=[],f=!1;function l(){a=o.map((function(e){return u(e.props.triggerTarget||e.reference)})).reduce((function(e,t){return e.concat(t)}),[])}function v(){i=o.map((function(e){return e.reference}))}function m(e){o.forEach((function(t){e?t.enable():t.disable()}))}function g(e){return o.map((function(t){var n=t.setProps;return t.setProps=function(o){n(o),t.reference===r&&e.setProps(o)},function(){t.setProps=n}}))}function h(e,t){var n=a.indexOf(t);if(t!==r){r=t;var s=(c||[]).concat("content").reduce((function(e,t){return e[t]=o[n].props[t],e}),{});e.setProps(Object.assign({},s,{getReferenceClientRect:"function"==typeof s.getReferenceClientRect?s.getReferenceClientRect:function(){var e;return null==(e=i[n])?void 0:e.getBoundingClientRect()}}))}}m(!1),v(),l();var b={fn:function(){return{onDestroy:function(){m(!0)},onHidden:function(){r=null},onClickOutside:function(e){e.props.showOnCreate&&!f&&(f=!0,r=null)},onShow:function(e){e.props.showOnCreate&&!f&&(f=!0,h(e,i[0]))},onTrigger:function(e,t){h(e,t.currentTarget)}}}},y=F(d(),Object.assign({},s(t,["overrides"]),{plugins:[b].concat(t.plugins||[]),triggerTarget:a,popperOptions:Object.assign({},t.popperOptions,{modifiers:[].concat((null==(n=t.popperOptions)?void 0:n.modifiers)||[],[W])})})),w=y.show;y.show=function(e){if(w(),!r&&null==e)return h(y,i[0]);if(!r||null!=e){if("number"==typeof e)return i[e]&&h(y,i[e]);if(o.indexOf(e)>=0){var t=e.reference;return h(y,t)}return i.indexOf(e)>=0?h(y,e):void 0}},y.showNext=function(){var e=i[0];if(!r)return y.show(0);var t=i.indexOf(r);y.show(i[t+1]||e)},y.showPrevious=function(){var e=i[i.length-1];if(!r)return y.show(e);var t=i.indexOf(r),n=i[t-1]||e;y.show(n)};var E=y.setProps;return y.setProps=function(e){c=e.overrides||c,E(e)},y.setInstances=function(e){m(!0),p.forEach((function(e){return e()})),o=e,m(!1),v(),l(),p=g(y),y.setProps({triggerTarget:a})},p=g(y),y},F.delegate=function(e,n){var r=[],o=[],i=!1,a=n.target,c=s(n,["target"]),p=Object.assign({},c,{trigger:"manual",touch:!1}),f=Object.assign({touch:R.touch},c,{showOnCreate:!0}),l=F(e,p);function d(e){if(e.target&&!i){var t=e.target.closest(a);if(t){var r=t.getAttribute("data-tippy-trigger")||n.trigger||R.trigger;if(!t._tippy&&!("touchstart"===e.type&&"boolean"==typeof f.touch||"touchstart"!==e.type&&r.indexOf(X[e.type])<0)){var s=F(t,f);s&&(o=o.concat(s))}}}}function v(e,t,n,o){void 0===o&&(o=!1),e.addEventListener(t,n,o),r.push({node:e,eventType:t,handler:n,options:o})}return u(l).forEach((function(e){var n=e.destroy,a=e.enable,s=e.disable;e.destroy=function(e){void 0===e&&(e=!0),e&&o.forEach((function(e){e.destroy()})),o=[],r.forEach((function(e){var t=e.node,n=e.eventType,r=e.handler,o=e.options;t.removeEventListener(n,r,o)})),r=[],n()},e.enable=function(){a(),o.forEach((function(e){return e.enable()})),i=!1},e.disable=function(){s(),o.forEach((function(e){return e.disable()})),i=!0},function(e){var n=e.reference;v(n,"touchstart",d,t),v(n,"mouseover",d),v(n,"focusin",d),v(n,"click",d)}(e)})),l},F.hideAll=function(e){var t=void 0===e?{}:e,n=t.exclude,r=t.duration;U.forEach((function(e){var t=!1;if(n&&(t=g(n)?e.reference===n:e.popper===n.popper),!t){var o=e.props.duration;e.setProps({duration:r}),e.hide(),e.state.isDestroyed||e.setProps({duration:o})}}))},F.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>',F}));

</script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ratio Estimators">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidycreel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/effort_survey_first.html">Effort (Survey-First)</a></li>
    <li><a class="dropdown-item" href="../articles/aerial.html">Aerial Effort</a></li>
    <li><a class="dropdown-item" href="../articles/survey_creel_terms.html">Survey Terms → Creel Translator</a></li>
    <li><a class="dropdown-item" href="../articles/replicate_designs_creel.html">Replicate Designs for Creel</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chrischizinski/tidycreel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ratio Estimators</h1>
      <p class="subtitle">When to Use Ratio-of-Means vs Mean-of-Ratios</p>

      <p class="date">2025-10-23</p>

      <small class="dont-index">Source: <a href="https://github.com/chrischizinski/tidycreel/blob/main/vignettes/ratio-estimators-guide.qmd" class="external-link"><code>vignettes/ratio-estimators-guide.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/" class="external-link">ggtext</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try to load tidycreel if available (for the practical examples)</span></span>
<span><span class="co"># The simulations work without it</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"tidycreel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chrischizinski/tidycreel" class="external-link">tidycreel</a></span><span class="op">)</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Note: tidycreel not installed. Practical examples will not run, but simulations will work."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<section class="level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>One of the most common questions in creel survey analysis is: “Should I use ratio-of-means or mean-of-ratios to estimate catch rate?”</p>
<p>This vignette answers that question through:</p>
<ol type="1">
<li>
<strong>Decision rules</strong> based on survey design type</li>
<li>
<strong>Simulation demonstrations</strong> showing estimator performance</li>
<li>
<strong>Practical guidance</strong> on variance estimation</li>
<li>
<strong>Clear examples</strong> using <code>tidycreel</code>
</li>
</ol></section><section class="level2"><h2 id="quick-answer-decision-tree">Quick Answer: Decision Tree<a class="anchor" aria-label="anchor" href="#quick-answer-decision-tree"></a>
</h2>
<pre><code># Code code example
┌─────────────────────────────────────────────┐
│   What type of interviews do you have?      │
└─────────────────┬───────────────────────────┘
                  │
        ┌─────────┴───────────┐
        │                     │
    ┌───▼──────┐          ┌───▼────────┐
    │ ACCESS   │          │ ROVING     │
    │(Complete │          │(Incomplete │
    │ trips)   │          │  trips)    │
    └───┬──────┘          └───┬────────┘
        │                     │
        │                     │
    ┌───▼─────────────────┐   │
    │ Use RATIO-OF-MEANS  │   │
    │  R₁ = Σcatch/Σeffort│   │
    │                     │   │
    │ Why? Each angler    │   │
    │ has equal sampling  │   │
    │ probability.        │   │
    │                     │   │
    │ ✓ Unbiased          │   │
    │ ✓ Finite variance   │   │
    └─────────────────────┘   │
                              │
                  ┌───────────▼────────────────┐
                  │ Use MEAN-OF-RATIOS         │
                  │  R₂ = (1/n)Σ(catch/effort) │
                  │                            │
                  │ IMPORTANT: Truncate short  │
                  │ trips (&lt; 20-30 minutes)    │
                  │                            │
                  │ Why? Sampling probability  │
                  │ ∝ trip length. R₁ would    │
                  │ give biased estimate.      │
                  │                            │
                  │ ⚠ Avoid if bag limits      │
                  │   are low &amp; easily obtained│
                  └────────────────────────────┘</code></pre>
</section><section class="level2"><h2 id="theoretical-background">Theoretical Background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<p>Before diving into simulations and practical examples, let’s establish the statistical foundation for why estimator choice matters. The key is understanding how sampling probabilities differ between survey designs.</p>
<section class="level3"><h3 id="access-point-complete-trip-interviews">Access Point (Complete Trip) Interviews<a class="anchor" aria-label="anchor" href="#access-point-complete-trip-interviews"></a>
</h3>
<p>Sampling Design:</p>
<p>complete - Interviews conducted as anglers complete their trips equal probability - All anglers have equal probability of being interviewed - P(interviewed) = constant, regardless of trip length</p>
<p>Appropriate Estimator: Ratio-of-Means (R₁)</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>C</mi><mi>j</mi><mo>*</mo></msubsup></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>L</mi><mi>j</mi><mo>*</mo></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{R}_1 = \frac{\sum_{j=1}^{n} C_j^*}{\sum_{j=1}^{n} L_j^*}</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>C</mi><mi>j</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">C_j^*</annotation></semantics></math> = total catch for the completed trip and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>L</mi><mi>j</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">L_j^*</annotation></semantics></math> = total trip length at completion.</p>
<p>Expected Value: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mtext mathvariant="normal">Total Catch</mtext><mtext mathvariant="normal">Total Effort</mtext></mfrac></mrow><annotation encoding="application/x-tex">E(\hat{R}_1) \approx \frac{\text{Total Catch}}{\text{Total Effort}}</annotation></semantics></math></p>
<p>✓ This is what we want for total catch estimation!</p>
</section><section class="level3"><h3 id="roving-incomplete-trip-interviews">Roving (Incomplete Trip) Interviews<a class="anchor" aria-label="anchor" href="#roving-incomplete-trip-interviews"></a>
</h3>
<p>Sampling Design:</p>
<p>during - Interviews conducted during fishing trips ∝ trip length - Sampling probability ∝ trip length - Longer trips are more likely to be encountered</p>
<p>Appropriate Estimator: Mean-of-Ratios (R₂) with Truncation</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><msub><mi>C</mi><mi>j</mi></msub><msub><mi>L</mi><mi>j</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\hat{R}_2 = \frac{1}{n} \sum_{j=1}^{n} \frac{C_j}{L_j}</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>j</mi></msub><annotation encoding="application/x-tex">C_j</annotation></semantics></math> = catch at time of interview and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>j</mi></msub><annotation encoding="application/x-tex">L_j</annotation></semantics></math> = elapsed time at interview.</p>
<p>With truncation: Only include interviews where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>j</mi></msub><mo>&gt;</mo><msub><mi>L</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_j &gt; L_{min}</annotation></semantics></math> (typically 20-30 minutes).</p>
<p>Expected Value: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mtext mathvariant="normal">Total Catch</mtext><mtext mathvariant="normal">Total Effort</mtext></mfrac></mrow><annotation encoding="application/x-tex">E(\hat{R}_2) \approx \frac{\text{Total Catch}}{\text{Total Effort}}</annotation></semantics></math></p>
<p>✓ Correct for roving interviews!</p>
<p>Why NOT use R₁ for roving?</p>
<p>The ratio-of-means for roving interviews has: <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>1</mn><mrow><mi>r</mi><mi>o</mi><mi>v</mi><mi>i</mi><mi>n</mi><mi>g</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mrow><mo>∑</mo><msubsup><mi>L</mi><mi>j</mi><mrow><mi>*</mi><mn>2</mn></mrow></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>C</mi><mi>j</mi><mo>*</mo></msubsup><mi>/</mi><msubsup><mi>L</mi><mi>j</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>∑</mo><msubsup><mi>L</mi><mi>j</mi><mrow><mi>*</mi><mn>2</mn></mrow></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">E(\hat{R}_1^{roving}) \approx \frac{\sum L_j^{*2} \cdot (C_j^*/L_j^*)}{\sum L_j^{*2}}</annotation></semantics></math></p>
<p>This is a weighted average with weights = (trip length)², which does not estimate the population catch rate!</p>
</section></section><section class="level2"><h2 id="handling-mixed-complete-and-incomplete-trips">Handling Mixed Complete and Incomplete Trips<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips"></a>
</h2>
<p><strong>Why this matters.</strong> Real creel surveys often produce a mix of <em>completed</em> (access-point) and <em>incomplete</em> (roving/intercept) interviews. Estimator choice must follow the <strong>inclusion probability</strong>, not just trip status, to avoid bias.</p>
<section class="level3"><h3 id="principle">Principle<a class="anchor" aria-label="anchor" href="#principle"></a>
</h3>
<p>When inclusion probability differs by design (equal-probability at access points vs. length-biased in roving), pooling interviews and applying a single estimator can introduce bias. Treat designs according to their sampling properties.</p>
</section><section class="level3"><h3 id="separate-estimation-recommended">1️⃣ Separate Estimation (Recommended)<a class="anchor" aria-label="anchor" href="#separate-estimation-recommended"></a>
</h3>
<p>Treat complete and incomplete interviews as two strata, then combine by <strong>effort weighting</strong>:</p>
<ul>
<li>
<strong>Complete trips (access point):</strong> use <em>Ratio-of-Means</em> (R₁ = ΣC / ΣE).</li>
<li>
<strong>Incomplete trips (roving):</strong> use <em>Mean-of-Ratios</em> (R₂ = (1/n) Σ(C/E)) with <strong>truncation</strong> of short trips (e.g., &lt; 20–30 min).</li>
</ul>
<p><strong>Effort-weighted combination:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">combined</mtext></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mn>1</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>R</mi><mn>2</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow><mrow><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{combined}} = \frac{R_1 E_{\text{complete}} + R_2 E_{\text{incomplete}}}{E_{\text{complete}} + E_{\text{incomplete}}}
</annotation></semantics></math></p>
</section><section class="level3"><h3 id="model-based-weighting-optional">2️⃣ Model-Based Weighting (optional)<a class="anchor" aria-label="anchor" href="#model-based-weighting-optional"></a>
</h3>
<p>If you can estimate selection/inclusion probabilities (e.g., a model for trip completeness or roving intercept likelihood), use a weighted ratio:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">weighted</mtext></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>C</mi><mi>i</mi></msub></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>E</mi><mi>i</mi></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">select</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{weighted}} = \frac{\sum_i w_i C_i}{\sum_i w_i E_i}, \quad w_i = 1 / P(\text{select}_i).
</annotation></semantics></math></p>
<p>This is useful for hybrid designs where sampling varies predictably across modes, times, or sites.</p>
</section><section class="level3"><h3 id="sensitivity-analysis">3️⃣ Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h3>
<p>Compute: (a) R₁ on complete only, (b) R₂ on incomplete (with truncation), and (c) the combined estimator. If differences are small (e.g., &lt; 5–10%), pooling assumptions may be reasonable; document them.</p>
</section><section class="level3"><h3 id="cautions">Cautions<a class="anchor" aria-label="anchor" href="#cautions"></a>
</h3>
<ul>
<li>Do <strong>not</strong> apply R₁ to unfiltered roving data — it is biased high due to length-biased sampling.</li>
<li>Do <strong>not</strong> apply R₂ to complete trips only — bias direction depends on effort variability.</li>
<li>Always truncate short incomplete trips to stabilize R₂ and reduce small-denominator issues.</li>
<li>When bag limits are frequently hit, be cautious with R₂ (ceiling effects can distort ratios).</li>
</ul></section><section class="level3"><h3 id="implementation-sketch-r">Implementation sketch (R)<a class="anchor" aria-label="anchor" href="#implementation-sketch-r"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="va">complete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">incomplete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># 0.5 h = 30 min</span></span>
<span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R_combined</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">r1</span> <span class="op">*</span> <span class="va">E1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">*</span> <span class="va">E2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">E1</span> <span class="op">+</span> <span class="va">E2</span><span class="op">)</span></span></code></pre></div>
</section><section class="level3"><h3 id="variance-note">Variance note<a class="anchor" aria-label="anchor" href="#variance-note"></a>
</h3>
<p>Estimate SEs for each stratum with the appropriate formula (delta-method for R₁; sample variance of ratios for R₂), then combine via delta-method using the effort-weight combination above.</p>
</section></section><section class="level2"><h2 id="simulation-study">Simulation Study<a class="anchor" aria-label="anchor" href="#simulation-study"></a>
</h2>
<p>The theoretical results above show why estimator choice matters. But how large is the bias in practice? And does truncation really help?</p>
<p>Let’s demonstrate these principles through simulation, following the approach of Rasmussen et al. (1998) and Pollock et al. (1997).</p>
<section class="level3"><h3 id="simulation-setup">Simulation Setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h3>
<p>We’ll simulate a realistic fishing scenario and compare estimator performance.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co">#' Simulate a day of fishing with known parameters</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param n_anglers Number of anglers fishing during the day</span></span>
<span><span class="co">#' @param mean_trip_hours Mean trip length (hours)</span></span>
<span><span class="co">#' @param mean_catch_rate Mean catch per hour (Poisson rate parameter)</span></span>
<span><span class="co">#' @param day_length_hours Length of fishing day</span></span>
<span><span class="co">#' @return List with population parameters and individual angler data</span></span>
<span><span class="va">simulate_fishing_day</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 <span class="va">mean_trip_hours</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                 <span class="va">mean_catch_rate</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                 <span class="va">day_length_hours</span> <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Each angler's true catch rate (gamma-distributed for heterogeneity)</span></span>
<span>  <span class="co"># Shape = 1, rate = 1/mean gives exponential with specified mean</span></span>
<span>  <span class="co"># This creates variation in angler skill/success</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">mean_catch_rate</span></span>
<span>  <span class="va">catch_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">alpha</span>, rate <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Trip lengths (gamma-distributed)</span></span>
<span>  <span class="va">shape_trip</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co"># Controls variability</span></span>
<span>  <span class="va">rate_trip</span> <span class="op">&lt;-</span> <span class="va">shape_trip</span> <span class="op">/</span> <span class="va">mean_trip_hours</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">shape_trip</span>, rate <span class="op">=</span> <span class="va">rate_trip</span><span class="op">)</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_lengths</span>, <span class="va">day_length_hours</span><span class="op">)</span>  <span class="co"># Can't exceed day length</span></span>
<span></span>
<span>  <span class="co"># Generate catches for each angler (Poisson process)</span></span>
<span>  <span class="co"># Expected catch = catch_rate * trip_length</span></span>
<span>  <span class="va">completed_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_anglers</span>, lambda <span class="op">=</span> <span class="va">catch_rates</span> <span class="op">*</span> <span class="va">trip_lengths</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># True population parameters</span></span>
<span>  <span class="va">total_effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trip_lengths</span><span class="op">)</span></span>
<span>  <span class="va">total_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">completed_catch</span><span class="op">)</span></span>
<span>  <span class="va">true_catch_rate</span> <span class="op">&lt;-</span> <span class="va">total_catch</span> <span class="op">/</span> <span class="va">total_effort</span></span>
<span></span>
<span>  <span class="co"># Return angler-level data</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_anglers</span>,</span>
<span>    catch_rate_true <span class="op">=</span> <span class="va">catch_rates</span>,</span>
<span>    trip_length <span class="op">=</span> <span class="va">trip_lengths</span>,</span>
<span>    completed_catch <span class="op">=</span> <span class="va">completed_catch</span>,</span>
<span>    true_population_rate <span class="op">=</span> <span class="va">true_catch_rate</span>,</span>
<span>    total_effort <span class="op">=</span> <span class="va">total_effort</span>,</span>
<span>    total_catch <span class="op">=</span> <span class="va">total_catch</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example</span></span>
<span><span class="va">fishing_day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
# A tibble: 6 × 7
  angler_id catch_rate_true trip_length completed_catch true_population_rate
      &lt;int&gt;           &lt;dbl&gt;       &lt;dbl&gt;           &lt;int&gt;                &lt;dbl&gt;
1         1           2.00         4.78               7                 2.15
2         2           2.26         1.56               5                 2.15
3         3           0.851        4.74               4                 2.15
4         4           1.03         6.06               5                 2.15
5         5           6.96         4.52              35                 2.15
6         6           0.627        5.59               3                 2.15
# ℹ 2 more variables: total_effort &lt;dbl&gt;, total_catch &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Summary of true population parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True Population Parameters:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
True Population Parameters:</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total anglers:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
  Total anglers: 100 </code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total effort:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">total_effort</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"hours\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
  Total effort: 391.8 hours</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total catch:"</span>, <span class="va">fishing_day</span><span class="op">$</span><span class="va">total_catch</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"fish\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
  Total catch: 844 fish</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  True catch rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"fish/hour\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
  True catch rate: 2.154 fish/hour</code></pre>
</section><section class="level3"><h3 id="scenario-1-access-point-interviews-complete-trips">Scenario 1: Access Point Interviews (Complete Trips)<a class="anchor" aria-label="anchor" href="#scenario-1-access-point-interviews-complete-trips"></a>
</h3>
<p>Simulate a traditional access point creel where we interview anglers as they finish.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co">#' Simulate access point interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Number of interviews to conduct</span></span>
<span><span class="co">#' @return Tibble with interview data</span></span>
<span><span class="va">sample_access_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Simple random sample (equal probability)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Single realization</span></span>
<span><span class="va">access_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
# A tibble: 6 × 4
  angler_id completed_catch trip_length true_population_rate
      &lt;int&gt;           &lt;int&gt;       &lt;dbl&gt;                &lt;dbl&gt;
1         1               7        4.78                 2.15
2        69               4        5.05                 2.15
3        79              14        6.27                 2.15
4        19               5        6.75                 2.15
5        12               1        4.72                 2.15
6        64               0        5.88                 2.15</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Calculate both estimators</span></span>
<span><span class="va">calculate_estimates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">truncate_minutes</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Apply truncation if specified (for roving surveys)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">truncate_minutes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">interviews</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="va">truncate_minutes</span> <span class="op">/</span> <span class="fl">60</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Ratio-of-means</span></span>
<span>  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Mean-of-ratios</span></span>
<span>  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Variance estimates (simplified)</span></span>
<span>  <span class="co"># For R₁: use delta method (Taylor series approximation)</span></span>
<span>  <span class="co"># Var(R₁) ≈ (1/n·E̅²) · Var(C - R₁·E)</span></span>
<span>  <span class="co"># where residual = catch - estimated_rate × effort</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">r_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">e_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">var_r1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">e_bar</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="va">r1</span> <span class="op">*</span> <span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">se_r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># For R₂: simple variance of the ratios</span></span>
<span>  <span class="va">ratios</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">var_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">ratios</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span>
<span>  <span class="va">se_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    ratio_of_means <span class="op">=</span> <span class="va">r1</span>,</span>
<span>    mean_of_ratios <span class="op">=</span> <span class="va">r2</span>,</span>
<span>    se_r1 <span class="op">=</span> <span class="va">se_r1</span>,</span>
<span>    se_r2 <span class="op">=</span> <span class="va">se_r2</span>,</span>
<span>    true_rate <span class="op">=</span> <span class="va">interviews</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">access_results</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span>
<span><span class="va">access_results</span></span></code></pre></div>
<pre><code># Code code example
# A tibble: 1 × 6
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1    30           2.04           2.41 0.401 0.463      2.15</code></pre>
</section><section class="level3"><h3 id="scenario-2-roving-interviews-incomplete-trips">Scenario 2: Roving Interviews (Incomplete Trips)<a class="anchor" aria-label="anchor" href="#scenario-2-roving-interviews-incomplete-trips"></a>
</h3>
<p>Now simulate roving interviews where anglers are intercepted during their trips.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co">#' Simulate roving interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Target number of interviews</span></span>
<span><span class="co">#' @return Tibble with incomplete trip interview data</span></span>
<span><span class="va">sample_roving_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Length-biased sampling: probability of encounter ∝ trip duration</span></span>
<span>  <span class="co"># P(interview angler i) = L_i / Σ L_j (normalized by total effort)</span></span>
<span>  <span class="co"># Longer trips have higher chance of being encountered during roving</span></span>
<span>  <span class="va">prob_intercept</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Sample with probability proportional to size</span></span>
<span>  <span class="va">sampled_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    prob <span class="op">=</span> <span class="va">prob_intercept</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">[</span><span class="va">sampled_indices</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="co"># For each intercepted angler, determine interview time</span></span>
<span>  <span class="co"># Uniform on [0, trip_length] (on average, intercepted at midpoint)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">sampled</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="co"># Time fished when interviewed (uniform on [0, trip_length])</span></span>
<span>      <span class="co"># On average, anglers are intercepted at midpoint of their trip</span></span>
<span>      time_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span>,</span>
<span></span>
<span>      <span class="co"># Catch at interview time (incomplete trip)</span></span>
<span>      <span class="co"># Poisson process: E[catch | time_t] = λ × t</span></span>
<span>      <span class="co"># where λ = angler's true catch rate, t = time fished so far</span></span>
<span>      catch_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="va">catch_rate_true</span> <span class="op">*</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">catch_at_interview</span>, <span class="va">time_at_interview</span>,</span>
<span>           <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">roving_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">roving_sample</span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
# A tibble: 6 × 6
  angler_id catch_at_interview time_at_interview completed_catch trip_length
      &lt;int&gt;              &lt;int&gt;             &lt;dbl&gt;           &lt;int&gt;       &lt;dbl&gt;
1        27                  1             2.57                2        5.27
2        37                  4             1.46               13        2.99
3        81                  0             0.326               3        3.86
4        32                  1             2.30                8        5.76
5        97                  6             3.54               10        4.81
6        28                  4             2.58                5        2.72
# ℹ 1 more variable: true_population_rate &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># For roving, use incomplete data</span></span>
<span><span class="co"># Note: calculate_estimates() expects columns named 'completed_catch' and 'trip_length'</span></span>
<span><span class="va">roving_data</span> <span class="op">&lt;-</span> <span class="va">roving_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>,</span>
<span>         completed_catch <span class="op">=</span> <span class="va">catch_at_interview</span>,</span>
<span>         trip_length <span class="op">=</span> <span class="va">time_at_interview</span>,</span>
<span>         <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># No truncation</span></span>
<span><span class="va">roving_no_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With truncation (30 minutes)</span></span>
<span><span class="va">roving_with_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">roving_no_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span>,</span>
<span>  <span class="va">roving_with_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"30 min"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># Code code example
# A tibble: 2 × 7
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate truncation
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1    30           1.98           1.77 0.329 0.289      2.15 None
2    27           1.97           1.67 0.334 0.281      2.15 30 min    </code></pre>
</section><section class="level3"><h3 id="monte-carlo-simulation">Monte Carlo Simulation<a class="anchor" aria-label="anchor" href="#monte-carlo-simulation"></a>
</h3>
<p>Run 1000 replications to assess bias and precision.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="va">run_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                           <span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                           <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                           <span class="va">interview_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"access"</span>, <span class="st">"roving"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">interview_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">interview_type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate population</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="va">n_anglers</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Sample based on design</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">interview_type</span> <span class="op">==</span> <span class="st">"access"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">completed_catch</span>, effort <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Calculate estimators</span></span>
<span>    <span class="co"># No truncation</span></span>
<span>    <span class="va">r1_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="va">r2_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># With truncation (30 min = 0.5 hr)</span></span>
<span>    <span class="va">trunc_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      rep <span class="op">=</span> <span class="va">rep</span>,</span>
<span>      true_rate <span class="op">=</span> <span class="va">true_rate</span>,</span>
<span>      r1_no_trunc <span class="op">=</span> <span class="va">r1_no</span>,</span>
<span>      r2_no_trunc <span class="op">=</span> <span class="va">r2_no</span>,</span>
<span>      r1_with_trunc <span class="op">=</span> <span class="va">r1_trunc</span>,</span>
<span>      r2_with_trunc <span class="op">=</span> <span class="va">r2_trunc</span>,</span>
<span>      n_interviews <span class="op">=</span> <span class="va">n_interviews</span>,</span>
<span>      n_after_trunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">interview_type</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run simulations</span></span>
<span><span class="va">access_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"access"</span><span class="op">)</span></span>
<span><span class="va">roving_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"roving"</span><span class="op">)</span></span></code></pre></div>
</section><section class="level3"><h3 id="results-access-point-design">Results: Access Point Design<a class="anchor" aria-label="anchor" href="#results-access-point-design"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="va">access_summary</span> <span class="op">&lt;-</span> <span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Ratio of means (R₁)</span></span>
<span>    r1_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span>    r1_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r1_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Mean of ratios (R₂)</span></span>
<span>    r2_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>    r2_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r2_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">access_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"metric"</span><span class="op">)</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, values_to <span class="op">=</span> <span class="st">"value"</span>, names_repair <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct</span>, <span class="va">se</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pct_bias <span class="op">=</span> <span class="va">pct</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Access Point Design: Estimator Performance"</span><span class="op">)</span></span></code></pre></div>
<p>Access Point Design: Estimator Performance estimator mean bias pct_bias se rmse r1 1.9953 -0.0069 -0.3452 0.4276 0.4274 r2 2.0081 0.0059 0.2955 0.4081 0.4079 Key Finding: For access interviews, both estimators are approximately unbiased, but ratio-of-means (R₁) typically has slightly lower variance.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>,</span>
<span>      r1_no_trunc <span class="op">=</span> <span class="st">"Ratio of Means (R1)"</span>,</span>
<span>      r2_no_trunc <span class="op">=</span> <span class="st">"Mean of Ratios (R2)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># NEW: HTML subscripts for facet strips</span></span>
<span>    estimator_lab <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>,</span>
<span>      <span class="st">"Ratio of Means (R1)"</span> <span class="op">=</span> <span class="st">"R&lt;sub&gt;1&lt;/sub&gt; (Ratio of Means)"</span>,</span>
<span>      <span class="st">"Mean of Ratios (R2)"</span> <span class="op">=</span> <span class="st">"R&lt;sub&gt;2&lt;/sub&gt; (Mean of Ratios)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">estimator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">estimator_lab</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Access Point Design: Sampling Distribution"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Dashed line = true population catch rate"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Estimated Catch Rate (fish/hour)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    <span class="co"># NEW: render HTML in strip labels</span></span>
<span>    strip.text <span class="op">=</span> <span class="fu">ggtext</span><span class="fu">::</span><span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure><p><img role="img" src="ratio-estimators-guide_files/figure-html/access-plot-1.png"></p>
<figcaption>Access Point Design: Distribution of Estimates. Both estimators center on the true value (dashed line), demonstrating unbiasedness. The ratio-of-means (R₁) shows slightly tighter clustering, indicating lower variance.</figcaption></figure>
</div>
</section><section class="level3"><h3 id="results-roving-design">Results: Roving Design<a class="anchor" aria-label="anchor" href="#results-roving-design"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="va">roving_summary</span> <span class="op">&lt;-</span> <span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 no truncation</span></span>
<span>    r1_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 no truncation</span></span>
<span>    r2_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 with truncation</span></span>
<span>    r1_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 with truncation</span></span>
<span>    r2_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">roving_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"truncation"</span>, <span class="st">"metric"</span><span class="op">)</span>,</span>
<span>               names_pattern <span class="op">=</span> <span class="st">"([^_]+)_([^_]+)_(.*)"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>, r1 <span class="op">=</span> <span class="st">"Ratio of Means"</span>, r2 <span class="op">=</span> <span class="st">"Mean of Ratios"</span><span class="op">)</span>,</span>
<span>         truncation <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">truncation</span>, no <span class="op">=</span> <span class="st">"No truncation"</span>, trunc <span class="op">=</span> <span class="st">"30-min truncation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">truncation</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct_bias</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Roving Design: Estimator Performance"</span><span class="op">)</span></span></code></pre></div>
<p>Roving Design: Estimator Performance estimator truncation mean bias pct_bias rmse Ratio of Means No truncation 1.9957 -0.0209 -1.0341 0.4985 Mean of Ratios No truncation 1.9909 -0.0256 -1.2698 0.4629 Ratio of Means 30-min truncation 1.9966 -0.0199 -0.9880 0.5041 Mean of Ratios 30-min truncation 2.0092 -0.0073 -0.3629 0.4400 Key Findings:</p>
<p>R₁ (ratio-of-means) is BIASED for roving interviews 1. R₁ (ratio-of-means) is BIASED for roving interviews - does not estimate population catch rate R₂ (mean-of-ratios) without truncation is approximately unbiased BUT has high variance 2. R₂ (mean-of-ratios) without truncation is approximately unbiased BUT has high variance (unstable) R₂ with truncation is approximately unbiased AND has lower variance RECOMMENDED 3. R₂ with truncation is approximately unbiased AND has lower variance ✓ RECOMMENDED</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"r1"</span> <span class="op">=</span> <span class="st">"italic(R)[1]~'(Ratio~of~Means)'"</span>,</span>
<span>  <span class="st">"r2"</span> <span class="op">=</span> <span class="st">"italic(R)[2]~'(Mean~of~Ratios)'"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span>, <span class="va">r1_with_trunc</span>, <span class="va">r2_with_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Estimator_lab <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Estimator</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>,<span class="st">"Ratio of Means"</span>,<span class="st">"Ratio-of-Means"</span>,<span class="st">"R_1"</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"R&lt;sub&gt;1&lt;/sub&gt; (Ratio of Means)"</span>,</span>
<span>      <span class="va">Estimator</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R2"</span>,<span class="st">"Mean of Ratios"</span>,<span class="st">"Mean-of-Ratios"</span>,<span class="st">"R_2"</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"R&lt;sub&gt;2&lt;/sub&gt; (Mean of Ratios)"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Estimator</span></span>
<span>    <span class="op">)</span>,</span>
<span>    Truncation_lab <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Truncation</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"30-Min Truncation"</span>,<span class="st">"30 min"</span>,<span class="st">"30min"</span>,<span class="st">"30"</span><span class="op">)</span> <span class="op">~</span></span>
<span>        <span class="st">"30-Min Truncation"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"No Truncation"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">Estimator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ... geoms ...</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">Estimator_lab</span> <span class="op">~</span> <span class="va">Truncation_lab</span>, switch <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    strip.text.x <span class="op">=</span> <span class="fu">ggtext</span><span class="fu">::</span><span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text.y <span class="op">=</span> <span class="fu">ggtext</span><span class="fu">::</span><span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure><p><img role="img" src="ratio-estimators-guide_files/figure-html/roving-plot-1.png"></p>
<figcaption>Roving Design: Effect of Truncation. R₁ (ratio-of-means) is biased for roving surveys regardless of truncation. R₂ (mean-of-ratios) is unbiased but has high variance without truncation; truncation reduces variance while maintaining unbiasedness.</figcaption></figure>
</div>
</section></section><section class="level2"><h2 id="practical-implementation-with-tidycreel">Practical Implementation with tidycreel<a class="anchor" aria-label="anchor" href="#practical-implementation-with-tidycreel"></a>
</h2>
<section class="level3"><h3 id="access-point-survey-example">Access Point Survey Example<a class="anchor" aria-label="anchor" href="#access-point-survey-example"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Assuming you have complete-trip interview data</span></span>
<span><span class="va">interviews_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">4</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_interviews</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_complete</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use RATIO-OF-MEANS (default and recommended)</span></span>
<span><span class="va">cpue_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_interviews</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"ratio_of_means"</span>  <span class="co"># ✓ Correct for access interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_access</span></span></code></pre></div>
</section><section class="level3"><h3 id="roving-survey-example">Roving Survey Example<a class="anchor" aria-label="anchor" href="#roving-survey-example"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># Assuming you have incomplete-trip interview data</span></span>
<span><span class="va">interviews_incomplete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,  <span class="co"># Catch so far</span></span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, min <span class="op">=</span> <span class="fl">0.2</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,  <span class="co"># Time so far</span></span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORTANT: Truncate short trips before analysis</span></span>
<span><span class="va">interviews_truncated</span> <span class="op">&lt;-</span> <span class="va">interviews_incomplete</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">hours_fished</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Remove trips &lt; 30 minutes</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_roving</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_truncated</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use MEAN-OF-RATIOS for roving interviews</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_roving</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span>  <span class="co"># ✓ Correct for roving interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_roving</span></span></code></pre></div>
</section></section><section class="level2"><h2 id="variance-estimation">Variance Estimation<a class="anchor" aria-label="anchor" href="#variance-estimation"></a>
</h2>
<section class="level3"><h3 id="access-point-ratio-of-means">Access Point (Ratio-of-Means)<a class="anchor" aria-label="anchor" href="#access-point-ratio-of-means"></a>
</h3>
<p>For ratio-of-means with survey weights, the survey package automatically uses the delta method:</p>
<p>Note: These variance formulas assume sampling from an infinite (or very large) population. If your sample size is substantial relative to the total number of anglers (n/N &gt; 5%), you may want to apply a finite population correction (FPC): multiply the variance by (1 - n/N). However, for most creel surveys where the population of potential anglers is large, this correction is negligible.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mn>1</mn><mrow><mi>n</mi><msup><mover><mi>E</mi><mo accent="true">‾</mo></mover><mn>2</mn></msup></mrow></mfrac><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><mo>−</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>1</mn></msub><mi>E</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\hat{R}_1) \approx \frac{1}{n\bar{E}^2} \text{Var}(C - \hat{R}_1 E)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math> = catch, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math> = effort.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># survey::svyratio() provides proper variance</span></span>
<span><span class="va">cpue_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_interviews</span>, mode <span class="op">=</span> <span class="st">"ratio_of_means"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error is included</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">se</span></span>
<span></span>
<span><span class="co"># 95% confidence interval</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre></div>
</section><section class="level3"><h3 id="roving-mean-of-ratios-with-truncation">Roving (Mean-of-Ratios with Truncation)<a class="anchor" aria-label="anchor" href="#roving-mean-of-ratios-with-truncation"></a>
</h3>
<p>For mean-of-ratios, variance is straightforward:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>C</mi><mi>j</mi></msub><msub><mi>E</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}(\hat{R}_2) = \frac{1}{n} \text{Var}\left(\frac{C_j}{E_j}\right)</annotation></semantics></math></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="co"># survey::svymean() on the ratio variable</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_roving</span>, mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error and CIs included</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">se</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre></div>
</section></section><section class="level2"><h2 id="special-considerations">Special Considerations<a class="anchor" aria-label="anchor" href="#special-considerations"></a>
</h2>
<section class="level3"><h3 id="bag-limits">Bag Limits<a class="anchor" aria-label="anchor" href="#bag-limits"></a>
</h3>
<p>⚠️ CRITICAL WARNING: Roving surveys can produce severe negative bias (underestimation of 20-50%+) when bag limits are low (≤5 fish) and anglers comply by leaving immediately upon reaching the limit.</p>
<p>Problem: If anglers leave immediately after catching their limit, the roving clerk will encounter only unsuccessful anglers, leading to severe underestimation.</p>
<p>Example simulation (bag limit = 2 fish):</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R code example</span></span>
<span><span class="va">simulate_with_bag_limit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">bag_limit</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simulate fishing day</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Apply bag limit: anglers stop when limit reached</span></span>
<span>    <span class="va">day_limited</span> <span class="op">&lt;-</span> <span class="va">day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="co"># Time to reach bag limit (exponential waiting time)</span></span>
<span>        time_to_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">catch_rate_true</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                               <span class="va">bag_limit</span> <span class="op">/</span> <span class="va">catch_rate_true</span>,</span>
<span>                               <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual trip length (stop at limit or planned end, whichever comes first)</span></span>
<span>        actual_trip_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_length</span>, <span class="va">time_to_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual catch (capped at bag limit)</span></span>
<span>        actual_catch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">completed_catch</span>, <span class="va">bag_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Did angler reach bag limit before planned trip end?</span></span>
<span>        reached_limit <span class="op">=</span> <span class="op">(</span><span class="va">time_to_limit</span> <span class="op">&lt;</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Roving interviews can only encounter anglers still on-site</span></span>
<span>    <span class="co"># Those who reached bag limit before their planned trip end have already left</span></span>
<span>    <span class="co"># Only those who haven't reached the limit OR reached it at/after planned end are available</span></span>
<span>    <span class="va">still_fishing</span> <span class="op">&lt;-</span> <span class="va">day_limited</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">reached_limit</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">still_fishing</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Sample from those still fishing</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">still_fishing</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="va">r2</span>,</span>
<span>                     bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="cn">NA</span>, bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bag_limit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op">&lt;-</span> <span class="va">bag_limit_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">bag_limit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    mean_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span>,</span>
<span>    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Roving Bias Under Different Bag Limits"</span><span class="op">)</span></span></code></pre></div>
<p>Roving Bias Under Different Bag Limits bag_limit true_rate mean_estimate bias pct_bias 2 2.010 0.341 -1.668 -83.017 5 2.001 0.655 -1.346 -67.286 10 2.003 1.021 -0.982 -49.014 Recommendation: If bag limits are low (≤5 fish) and compliance is high, use access point interviews instead of roving.</p>
</section><section class="level3"><h3 id="nonstationary-catch-rates">Nonstationary Catch Rates<a class="anchor" aria-label="anchor" href="#nonstationary-catch-rates"></a>
</h3>
<p>If catch rates change systematically during trips (e.g., learning curve, time-of-day effects), roving interviews may be biased.</p>
<p>Check this by:</p>
<ol type="1">
<li>Comparing incomplete-trip catch rates to complete-trip catch rates</li>
<li>Looking for patterns in catch rate vs. time-of-day</li>
</ol>
<p>If nonstationary: Consider access point interviews or model the time-varying catch rate.</p>
</section></section><section class="level2"><h2 id="summary-practical-guidelines">Summary: Practical Guidelines<a class="anchor" aria-label="anchor" href="#summary-practical-guidelines"></a>
</h2>
<section class="level3"><h3 id="decision-rules">Decision Rules<a class="anchor" aria-label="anchor" href="#decision-rules"></a>
</h3>
<p>Survey Type Interview Type Recommended Estimator Function Call Access point Complete trips Ratio-of-means (R₁) est_cpue(…, mode = “ratio_of_means”) Roving Incomplete trips Mean-of-ratios (R₂) with truncation est_cpue(…, mode = “mean_of_ratios”) + filter short trips Complemented (aerial-access) Complete trips Ratio-of-means (R₁) est_cpue(…, mode = “ratio_of_means”) Complemented (aerial-roving) Incomplete trips Mean-of-ratios (R₂) with truncation est_cpue(…, mode = “mean_of_ratios”) + filter</p>
</section><section class="level3"><h3 id="pre-processing-checklist">Pre-processing Checklist<a class="anchor" aria-label="anchor" href="#pre-processing-checklist"></a>
</h3>
<p>For ALL surveys:</p>
<p>Check for missing data in catch and effort - Check for missing data in catch and effort Verify effort &gt; 0 for all interviews - Verify effort &gt; 0 for all interviews Check for outliers (data entry errors) - Check for outliers (data entry errors)</p>
<p>For ROVING surveys specifically:</p>
<p>Truncate short trips (&lt; 20-30 minutes) - Truncate short trips (&lt; 20-30 minutes) Check bag limit compliance (may cause bias) - Check bag limit compliance (may cause bias) Verify catch rate stationarity (if possible) - Verify catch rate stationarity (if possible)</p>
</section><section class="level3"><h3 id="variance-estimation-checklist">Variance Estimation Checklist<a class="anchor" aria-label="anchor" href="#variance-estimation-checklist"></a>
</h3>
<p>Use proper survey weights in svydesign() - Use proper survey weights in svydesign() Include stratification variables - Include stratification variables Use svyratio() for ratio-of-means - Use svyratio() for ratio-of-means Use svymean() on catch/effort ratio for mean-of-ratios - Use svymean() on catch/effort ratio for mean-of-ratios Report standard errors and confidence intervals - Report standard errors and confidence intervals</p>
</section></section><section class="level2"><h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Pollock, K.H., Hoenig, J.M., Jones, C.M., Robson, D.S., &amp; Greene, C.J. (1997). Catch rate estimation for roving and access point surveys. North American Journal of Fisheries Management, 17(1), 11-19.</p>
<ul>
<li><p>Pollock, K.H., Hoenig, J.M., Jones, C.M., Robson, D.S., &amp; Greene, C.J. (1997). Catch rate estimation for roving and access point surveys. North American Journal of Fisheries Management , 17(1), 11-19. Rasmussen, P.W., Staggs, M.D., Beard, T.D., &amp; Newman, S.P. (1998). Bias and confidence interval coverage of creel survey estimators evaluated by simulation. Transactions of the American Fisheries Society, 127(3), 469-480.</p></li>
<li><p>Rasmussen, P.W., Staggs, M.D., Beard, T.D., &amp; Newman, S.P. (1998). Bias and confidence interval coverage of creel survey estimators evaluated by simulation. Transactions of the American Fisheries Society , 127(3), 469-480. Jones, C.M., Robson, D.S., Lakkis, H.D., &amp; Kressel, J. (1995). Properties of catch rates used in analysis of angler surveys. Transactions of the American Fisheries Society, 124(6), 911-928.</p></li>
<li><p>Jones, C.M., Robson, D.S., Lakkis, H.D., &amp; Kressel, J. (1995). Properties of catch rates used in analysis of angler surveys. Transactions of the American Fisheries Society , 124(6), 911-928. Lumley, T. (2004). Analysis of complex survey samples. Journal of Statistical Software, 9(1), 1-19.</p></li>
<li><p>Lumley, T. (2004). Analysis of complex survey samples. Journal of Statistical Software , 9(1), 1-19.</p></li>
</ul></section><section class="level2"><h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The choice between ratio-of-means and mean-of-ratios depends fundamentally on your survey design:</p>
<p>Access point interviews ratio-of-means - Access point interviews → Use ratio-of-means Roving interviews mean-of-ratios with truncation - Roving interviews → Use mean-of-ratios with truncation</p>
<p>The tidycreel package implements both estimators with proper variance estimation through the survey package. By following the decision rules in this vignette, you can ensure your catch rate estimates are unbiased and your confidence intervals have correct coverage.</p>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Chizinski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
