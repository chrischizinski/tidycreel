<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ratio Estimators: When to Use Ratio-of-Means vs Mean-of-Ratios • tidycreel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="ratio-estimators-guide_full_with_hybrid_files/libs/quarto-html/popper.min.js"></script><script src="ratio-estimators-guide_full_with_hybrid_files/libs/quarto-html/tippy.umd.min.js"></script><link href="ratio-estimators-guide_full_with_hybrid_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ratio-estimators-guide_full_with_hybrid_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ratio Estimators: When to Use Ratio-of-Means vs Mean-of-Ratios">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidycreel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/effort_survey_first.html">Effort (Survey-First)</a></li>
    <li><a class="dropdown-item" href="../articles/aerial.html">Aerial Effort</a></li>
    <li><a class="dropdown-item" href="../articles/survey_creel_terms.html">Survey Terms → Creel Translator</a></li>
    <li><a class="dropdown-item" href="../articles/replicate_designs_creel.html">Replicate Designs for Creel</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/chrischizinski/tidycreel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ratio Estimators: When to Use Ratio-of-Means vs Mean-of-Ratios</h1>




      <small class="dont-index">Source: <a href="https://github.com/chrischizinski/tidycreel/blob/main/vignettes/ratio-estimators-guide_full_with_hybrid.qmd" class="external-link"><code>vignettes/ratio-estimators-guide_full_with_hybrid.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <!-- Original HTML content with injected Hybrid section --><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<nav class="toc-active" id="TOC" role="doc-toc"><h2 id="toc-title">
Table of contents
</h2>
<ul>
<li>
<a class="nav-link active" data-scroll-target="#introduction" href="#introduction" id="toc-introduction">Introduction</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#quick-answer-decision-tree" href="#quick-answer-decision-tree" id="toc-quick-answer-decision-tree">Quick Answer: Decision Tree</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#theoretical-background" href="#theoretical-background" id="toc-theoretical-background">Theoretical Background</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#access-point-complete-trip-interviews" href="#access-point-complete-trip-interviews" id="toc-access-point-complete-trip-interviews">Access Point (Complete Trip) Interviews</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#roving-incomplete-trip-interviews" href="#roving-incomplete-trip-interviews" id="toc-roving-incomplete-trip-interviews">Roving (Incomplete Trip) Interviews</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#simulation-study" href="#simulation-study" id="toc-simulation-study">Simulation Study</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#simulation-setup" href="#simulation-setup" id="toc-simulation-setup">Simulation Setup</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#scenario-1-access-point-interviews-complete-trips" href="#scenario-1-access-point-interviews-complete-trips" id="toc-scenario-1-access-point-interviews-complete-trips">Scenario 1: Access Point Interviews (Complete Trips)</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#scenario-2-roving-interviews-incomplete-trips" href="#scenario-2-roving-interviews-incomplete-trips" id="toc-scenario-2-roving-interviews-incomplete-trips">Scenario 2: Roving Interviews (Incomplete Trips)</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#monte-carlo-simulation" href="#monte-carlo-simulation" id="toc-monte-carlo-simulation">Monte Carlo Simulation</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#results-access-point-design" href="#results-access-point-design" id="toc-results-access-point-design">Results: Access Point Design</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#results-roving-design" href="#results-roving-design" id="toc-results-roving-design">Results: Roving Design</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#practical-implementation-with-tidycreel" href="#practical-implementation-with-tidycreel" id="toc-practical-implementation-with-tidycreel">Practical Implementation with tidycreel</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#access-point-survey-example" href="#access-point-survey-example" id="toc-access-point-survey-example">Access Point Survey Example</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#roving-survey-example" href="#roving-survey-example" id="toc-roving-survey-example">Roving Survey Example</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#variance-estimation" href="#variance-estimation" id="toc-variance-estimation">Variance Estimation</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#access-point-ratio-of-means" href="#access-point-ratio-of-means" id="toc-access-point-ratio-of-means">Access Point (Ratio-of-Means)</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#roving-mean-of-ratios-with-truncation" href="#roving-mean-of-ratios-with-truncation" id="toc-roving-mean-of-ratios-with-truncation">Roving (Mean-of-Ratios with Truncation)</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#special-considerations" href="#special-considerations" id="toc-special-considerations">Special Considerations</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#bag-limits" href="#bag-limits" id="toc-bag-limits">Bag Limits</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#nonstationary-catch-rates" href="#nonstationary-catch-rates" id="toc-nonstationary-catch-rates">Nonstationary Catch Rates</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#summary-practical-guidelines" href="#summary-practical-guidelines" id="toc-summary-practical-guidelines">Summary: Practical Guidelines</a>
<ul class="collapse">
<li>
<a class="nav-link" data-scroll-target="#decision-rules" href="#decision-rules" id="toc-decision-rules">Decision Rules</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#pre-processing-checklist" href="#pre-processing-checklist" id="toc-pre-processing-checklist">Pre-processing Checklist</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#variance-estimation-checklist" href="#variance-estimation-checklist" id="toc-variance-estimation-checklist">Variance Estimation Checklist</a>
</li>
</ul>
</li>
<li>
<a class="nav-link" data-scroll-target="#references" href="#references" id="toc-references">References</a>
</li>
<li>
<a class="nav-link" data-scroll-target="#conclusion" href="#conclusion" id="toc-conclusion">Conclusion</a>
</li>
</ul></nav>
</div>
<main class="content" id="quarto-document-content"><header class="quarto-title-block default" id="title-block-header"><div class="quarto-title">
<h1 class="title">
Ratio Estimators: When to Use Ratio-of-Means vs Mean-of-Ratios
</h1>
</div>
<div class="quarto-title-meta">

</div>
</header><div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb1" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try to load tidycreel if available (for the practical examples)</span></span>
<span><span class="co"># The simulations work without it</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"tidycreel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chrischizinski/tidycreel" class="external-link">tidycreel</a></span><span class="op">)</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Note: tidycreel not installed. Practical examples will not run, but simulations will work."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
<section class="section level3"><h3 class="anchored" data-anchor-id="introduction" id="introduction">
Introduction
<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>
One of the most common questions in creel survey analysis is: <strong>“Should I use ratio-of-means or mean-of-ratios to estimate catch rate?”</strong>
</p>
<p>
This vignette answers that question through:
</p>
<ol type="1">
<li>
<strong>Decision rules</strong> based on survey design type
</li>
<li>
<strong>Simulation demonstrations</strong> showing estimator performance
</li>
<li>
<strong>Practical guidance</strong> on variance estimation
</li>
<li>
<strong>Clear examples</strong> using <code>tidycreel</code>
</li>
</ol></section><section class="section level3"><h3 class="anchored" data-anchor-id="quick-answer-decision-tree" id="quick-answer-decision-tree">
Quick Answer: Decision Tree
<a class="anchor" aria-label="anchor" href="#quick-answer-decision-tree"></a>
</h3>
<pre><code>┌─────────────────────────────────────────────┐
│   What type of interviews do you have?      │
└─────────────────┬───────────────────────────┘
                  │
        ┌─────────┴─────────┐
        │                   │
    ┌───▼──────┐          ┌───▼────────┐
    │ ACCESS   │          │ ROVING     │
    │(Complete │          │(Incomplete │
    │ trips)   │          │  trips)    │
    └───┬──────┘          └───┬────────┘
        │                     │
        │                     │
    ┌───▼─────────────────┐   │
    │ Use RATIO-OF-MEANS  │   │
    │  R₁ = Σcatch/Σeffort│   │
    │                     │   │
    │ Why? Each angler    │   │
    │ has equal sampling  │   │
    │ probability.        │   │
    │                     │   │
    │ ✓ Unbiased          │   │
    │ ✓ Finite variance   │   │
    └─────────────────────┘   │
                              │
                  ┌───────────▼────────────────┐
                  │ Use MEAN-OF-RATIOS         │
                  │  R₂ = (1/n)Σ(catch/effort) │
                  │                            │
                  │ IMPORTANT: Truncate short  │
                  │ trips (&lt; 20-30 minutes)    │
                  │                            │
                  │ Why? Sampling probability  │
                  │ ∝ trip length. R₁ would    │
                  │ give biased estimate.      │
                  │                            │
                  │ ⚠ Avoid if bag limits      │
                  │   are low &amp; easily obtained│
                  └────────────────────────────┘</code></pre>
</section><section class="section level3"><h3 class="anchored" data-anchor-id="theoretical-background" id="theoretical-background">
Theoretical Background
<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-complete-trip-interviews" id="access-point-complete-trip-interviews">
Access Point (Complete Trip) Interviews
<a class="anchor" aria-label="anchor" href="#access-point-complete-trip-interviews"></a>
</h4>
<p>
<strong>Sampling Design:</strong>
</p>
<ul>
<li>
Interviews conducted as anglers <strong>complete</strong> their trips
</li>
<li>
All anglers have <strong>equal probability</strong> of being interviewed
</li>
<li>
P(interviewed) = constant, regardless of trip length
</li>
</ul>
<p>
<strong>Appropriate Estimator: Ratio-of-Means (R₁)</strong>
</p>
<p>
<span class="math display">[_1 = ]</span>
</p>
<p>
where <span class="math inline">(C_j^<em>)</em></span><em> = total catch for the <strong>completed trip</strong> and <span class="math inline">(L_j^</span></em>) = total trip length <strong>at completion</strong>.
</p>
<p>
<strong>Expected Value:</strong> <span class="math display">[E(_1) ]</span>
</p>
<p>
✓ <strong>This is what we want for total catch estimation!</strong>
</p>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-incomplete-trip-interviews" id="roving-incomplete-trip-interviews">
Roving (Incomplete Trip) Interviews
<a class="anchor" aria-label="anchor" href="#roving-incomplete-trip-interviews"></a>
</h4>
<p>
<strong>Sampling Design:</strong>
</p>
<ul>
<li>
Interviews conducted <strong>during</strong> fishing trips
</li>
<li>
Sampling probability <strong>∝ trip length</strong>
</li>
<li>
Longer trips are more likely to be encountered
</li>
</ul>
<p>
<strong>Appropriate Estimator: Mean-of-Ratios (R₂) with Truncation</strong>
</p>
<p>
<span class="math display">[<em>2 = </em>{j=1}^{n} ]</span>
</p>
<p>
where <span class="math inline">(C_j)</span> = catch <strong>at time of interview</strong> and <span class="math inline">(L_j)</span> = elapsed time <strong>at interview</strong>.
</p>
<p>
<strong>With truncation:</strong> Only include interviews where <span class="math inline">(L_j &gt; L_{min})</span> (typically 20-30 minutes).
</p>
<p>
<strong>Expected Value:</strong> <span class="math display">[E(_2) ]</span>
</p>
<p>
✓ <strong>Correct for roving interviews!</strong>
</p>
<p>
<strong>Why NOT use R₁ for roving?</strong>
</p>
<p>
The ratio-of-means for roving interviews has: <span class="math display">[E(_1^{roving}) ]</span>
</p>
<p>
This is a <strong>weighted average</strong> with weights = (trip length)², which does <strong>not</strong> estimate the population catch rate!
</p>
</section><section class="level2"><h3 class="anchored" id="handling-mixed-complete-and-incomplete-trips">
Handling Mixed Complete and Incomplete Trips
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips"></a>
</h3>
<p>
<strong>Why this matters:</strong> Real creel surveys often produce a mix of <em>completed</em> (access-point) and <em>incomplete</em> (roving/intercept) interviews. Estimator choice must follow the <strong>inclusion probability</strong>, not just trip status, to avoid bias.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-1">
Principle
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-1"></a>
</h4>
<p>
When inclusion probability differs by design (equal-probability at access points vs. length-biased in roving), pooling interviews and applying a single estimator can introduce bias. Treat designs according to their sampling properties.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-2">
1️⃣ Separate Estimation (Recommended)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-2"></a>
</h4>
<p>
Treat complete and incomplete interviews as two strata, then combine by <strong>effort weighting</strong>:
</p>
<ul>
<li>
<strong>Complete trips (access point):</strong> use <em>Ratio-of-Means</em> (R₁ = ΣC / ΣE).
</li>
<li>
<strong>Incomplete trips (roving):</strong> use <em>Mean-of-Ratios</em> (R₂ = (1/n) Σ(C/E)) with <strong>truncation</strong> of short trips (e.g., &lt; 20–30 min).
</li>
</ul>
<p>
<strong>Effort-weighted combination:</strong>
</p>
<p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">combined</mtext></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mn>1</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>R</mi><mn>2</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow><mrow><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{combined}} = \frac{R_1 E_{\text{complete}} + R_2 E_{\text{incomplete}}}{E_{\text{complete}} + E_{\text{incomplete}}}
</annotation></semantics></math></p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-3">
2️⃣ Model-Based Weighting (optional)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-3"></a>
</h4>
<p>
If you can estimate selection/inclusion probabilities (e.g., a model for trip completeness or roving intercept likelihood), use a weighted ratio:
</p>
<p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">weighted</mtext></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>C</mi><mi>i</mi></msub></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>E</mi><mi>i</mi></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">select</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{weighted}} = \frac{\sum_i w_i C_i}{\sum_i w_i E_i}, \quad w_i = 1 / P(\text{select}_i).
</annotation></semantics></math></p>
<p>
This is useful for hybrid designs where sampling varies predictably across modes, times, or sites.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-4">
3️⃣ Sensitivity Analysis
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-4"></a>
</h4>
<p>
Compute: (a) R₁ on complete only, (b) R₂ on incomplete (with truncation), and (c) the combined estimator. If differences are small (e.g., &lt; 5–10%), pooling assumptions may be reasonable; document them.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-5">
Cautions
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-5"></a>
</h4>
<ul>
<li>
Do <strong>not</strong> apply R₁ to unfiltered roving data — it is biased high due to length-biased sampling.
</li>
<li>
Do <strong>not</strong> apply R₂ to complete trips only — bias direction depends on effort variability.
</li>
<li>
Always truncate short incomplete trips to stabilize R₂ and reduce small-denominator issues.
</li>
<li>
When bag limits are frequently hit, be cautious with R₂ (ceiling effects can distort ratios).
</li>
</ul>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-6">
Implementation sketch (R)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-6"></a>
</h4>
<pre><code class="language-r"><span><span class="va">complete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">incomplete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># 0.5 h = 30 min</span></span>
<span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R_combined</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">r1</span> <span class="op">*</span> <span class="va">E1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">*</span> <span class="va">E2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">E1</span> <span class="op">+</span> <span class="va">E2</span><span class="op">)</span></span></code></pre>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-7">
Variance note
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-7"></a>
</h4>
<p>
Estimate SEs for each stratum with the appropriate formula (delta-method for R₁; sample variance of ratios for R₂), then combine via delta-method using the effort-weight combination above.
</p>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="simulation-study" id="simulation-study">
Simulation Study
<a class="anchor" aria-label="anchor" href="#simulation-study"></a>
</h3>
<p>
The theoretical results above show <strong>why</strong> estimator choice matters. But how large is the bias in practice? And does truncation really help?
</p>
<p>
Let’s demonstrate these principles through simulation, following the approach of Rasmussen et al. (1998) and Pollock et al. (1997).
</p>
<section class="level3"><h4 class="anchored" data-anchor-id="simulation-setup" id="simulation-setup">
Simulation Setup
<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h4>
<p>
We’ll simulate a realistic fishing scenario and compare estimator performance.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb3" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate a day of fishing with known parameters</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param n_anglers Number of anglers fishing during the day</span></span>
<span><span class="co">#' @param mean_trip_hours Mean trip length (hours)</span></span>
<span><span class="co">#' @param mean_catch_rate Mean catch per hour (Poisson rate parameter)</span></span>
<span><span class="co">#' @param day_length_hours Length of fishing day</span></span>
<span><span class="co">#' @return List with population parameters and individual angler data</span></span>
<span><span class="va">simulate_fishing_day</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 <span class="va">mean_trip_hours</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                 <span class="va">mean_catch_rate</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                 <span class="va">day_length_hours</span> <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Each angler's true catch rate (gamma-distributed for heterogeneity)</span></span>
<span>  <span class="co"># Shape = 1, rate = 1/mean gives exponential with specified mean</span></span>
<span>  <span class="co"># This creates variation in angler skill/success</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">mean_catch_rate</span></span>
<span>  <span class="va">catch_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">alpha</span>, rate <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Trip lengths (gamma-distributed)</span></span>
<span>  <span class="va">shape_trip</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co"># Controls variability</span></span>
<span>  <span class="va">rate_trip</span> <span class="op">&lt;-</span> <span class="va">shape_trip</span> <span class="op">/</span> <span class="va">mean_trip_hours</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">shape_trip</span>, rate <span class="op">=</span> <span class="va">rate_trip</span><span class="op">)</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_lengths</span>, <span class="va">day_length_hours</span><span class="op">)</span>  <span class="co"># Can't exceed day length</span></span>
<span></span>
<span>  <span class="co"># Generate catches for each angler (Poisson process)</span></span>
<span>  <span class="co"># Expected catch = catch_rate * trip_length</span></span>
<span>  <span class="va">completed_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_anglers</span>, lambda <span class="op">=</span> <span class="va">catch_rates</span> <span class="op">*</span> <span class="va">trip_lengths</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># True population parameters</span></span>
<span>  <span class="va">total_effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trip_lengths</span><span class="op">)</span></span>
<span>  <span class="va">total_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">completed_catch</span><span class="op">)</span></span>
<span>  <span class="va">true_catch_rate</span> <span class="op">&lt;-</span> <span class="va">total_catch</span> <span class="op">/</span> <span class="va">total_effort</span></span>
<span></span>
<span>  <span class="co"># Return angler-level data</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_anglers</span>,</span>
<span>    catch_rate_true <span class="op">=</span> <span class="va">catch_rates</span>,</span>
<span>    trip_length <span class="op">=</span> <span class="va">trip_lengths</span>,</span>
<span>    completed_catch <span class="op">=</span> <span class="va">completed_catch</span>,</span>
<span>    true_population_rate <span class="op">=</span> <span class="va">true_catch_rate</span>,</span>
<span>    total_effort <span class="op">=</span> <span class="va">total_effort</span>,</span>
<span>    total_catch <span class="op">=</span> <span class="va">total_catch</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example</span></span>
<span><span class="va">fishing_day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  angler_id catch_rate_true trip_length completed_catch true_population_rate
      &lt;int&gt;           &lt;dbl&gt;       &lt;dbl&gt;           &lt;int&gt;                &lt;dbl&gt;
1         1           2.00         4.78               7                 2.15
2         2           2.26         1.56               5                 2.15
3         3           0.851        4.74               4                 2.15
4         4           1.03         6.06               5                 2.15
5         5           6.96         4.52              35                 2.15
6         6           0.627        5.59               3                 2.15
# ℹ 2 more variables: total_effort &lt;dbl&gt;, total_catch &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb5" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of true population parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True Population Parameters:\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>True Population Parameters:</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb7" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total anglers:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total anglers: 100 </code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb9" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total effort:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">total_effort</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"hours\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total effort: 391.8 hours</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb11" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total catch:"</span>, <span class="va">fishing_day</span><span class="op">$</span><span class="va">total_catch</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"fish\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total catch: 844 fish</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb13" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  True catch rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"fish/hour\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  True catch rate: 2.154 fish/hour</code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="scenario-1-access-point-interviews-complete-trips" id="scenario-1-access-point-interviews-complete-trips">
Scenario 1: Access Point Interviews (Complete Trips)
<a class="anchor" aria-label="anchor" href="#scenario-1-access-point-interviews-complete-trips"></a>
</h4>
<p>
Simulate a traditional access point creel where we interview anglers as they finish.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb15" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate access point interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Number of interviews to conduct</span></span>
<span><span class="co">#' @return Tibble with interview data</span></span>
<span><span class="va">sample_access_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Simple random sample (equal probability)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Single realization</span></span>
<span><span class="va">access_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  angler_id completed_catch trip_length true_population_rate
      &lt;int&gt;           &lt;int&gt;       &lt;dbl&gt;                &lt;dbl&gt;
1         1               7        4.78                 2.15
2        69               4        5.05                 2.15
3        79              14        6.27                 2.15
4        19               5        6.75                 2.15
5        12               1        4.72                 2.15
6        64               0        5.88                 2.15</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb17" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate both estimators</span></span>
<span><span class="va">calculate_estimates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">truncate_minutes</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Apply truncation if specified (for roving surveys)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">truncate_minutes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">interviews</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="va">truncate_minutes</span> <span class="op">/</span> <span class="fl">60</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Ratio-of-means</span></span>
<span>  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Mean-of-ratios</span></span>
<span>  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Variance estimates (simplified)</span></span>
<span>  <span class="co"># For R1: use delta method (Taylor series approximation)</span></span>
<span>  <span class="co"># Var(R₁) ≈ (1/n·E̅²) · Var(C - R₁·E)</span></span>
<span>  <span class="co"># where residual = catch - estimated_rate × effort</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">r_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">e_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">var_r1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">e_bar</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="va">r1</span> <span class="op">*</span> <span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">se_r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># For R2: simple variance of the ratios</span></span>
<span>  <span class="va">ratios</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">var_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">ratios</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span>
<span>  <span class="va">se_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    ratio_of_means <span class="op">=</span> <span class="va">r1</span>,</span>
<span>    mean_of_ratios <span class="op">=</span> <span class="va">r2</span>,</span>
<span>    se_r1 <span class="op">=</span> <span class="va">se_r1</span>,</span>
<span>    se_r2 <span class="op">=</span> <span class="va">se_r2</span>,</span>
<span>    true_rate <span class="op">=</span> <span class="va">interviews</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">access_results</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span>
<span><span class="va">access_results</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1    30           2.04           2.41 0.401 0.463      2.15</code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="scenario-2-roving-interviews-incomplete-trips" id="scenario-2-roving-interviews-incomplete-trips">
Scenario 2: Roving Interviews (Incomplete Trips)
<a class="anchor" aria-label="anchor" href="#scenario-2-roving-interviews-incomplete-trips"></a>
</h4>
<p>
Now simulate roving interviews where anglers are intercepted during their trips.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb19" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate roving interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Target number of interviews</span></span>
<span><span class="co">#' @return Tibble with incomplete trip interview data</span></span>
<span><span class="va">sample_roving_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Length-biased sampling: probability of encounter ∝ trip duration</span></span>
<span>  <span class="co"># P(interview angler i) = L_i / Σ L_j (normalized by total effort)</span></span>
<span>  <span class="co"># Longer trips have higher chance of being encountered during roving</span></span>
<span>  <span class="va">prob_intercept</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Sample with probability proportional to size</span></span>
<span>  <span class="va">sampled_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    prob <span class="op">=</span> <span class="va">prob_intercept</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">[</span><span class="va">sampled_indices</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="co"># For each intercepted angler, determine interview time</span></span>
<span>  <span class="co"># Uniform on [0, trip_length] (on average, intercepted at midpoint)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">sampled</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="co"># Time fished when interviewed (uniform on [0, trip_length])</span></span>
<span>      <span class="co"># On average, anglers are intercepted at midpoint of their trip</span></span>
<span>      time_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span>,</span>
<span></span>
<span>      <span class="co"># Catch at interview time (incomplete trip)</span></span>
<span>      <span class="co"># Poisson process: E[catch | time_t] = λ × t</span></span>
<span>      <span class="co"># where λ = angler's true catch rate, t = time fished so far</span></span>
<span>      catch_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="va">catch_rate_true</span> <span class="op">*</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">catch_at_interview</span>, <span class="va">time_at_interview</span>,</span>
<span>           <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">roving_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">roving_sample</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  angler_id catch_at_interview time_at_interview completed_catch trip_length
      &lt;int&gt;              &lt;int&gt;             &lt;dbl&gt;           &lt;int&gt;       &lt;dbl&gt;
1        27                  1             2.57                2        5.27
2        37                  4             1.46               13        2.99
3        81                  0             0.326               3        3.86
4        32                  1             2.30                8        5.76
5        97                  6             3.54               10        4.81
6        28                  4             2.58                5        2.72
# ℹ 1 more variable: true_population_rate &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb21" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For roving, use incomplete data</span></span>
<span><span class="co"># Note: calculate_estimates() expects columns named 'completed_catch' and 'trip_length'</span></span>
<span><span class="va">roving_data</span> <span class="op">&lt;-</span> <span class="va">roving_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>,</span>
<span>         completed_catch <span class="op">=</span> <span class="va">catch_at_interview</span>,</span>
<span>         trip_length <span class="op">=</span> <span class="va">time_at_interview</span>,</span>
<span>         <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># No truncation</span></span>
<span><span class="va">roving_no_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With truncation (30 minutes)</span></span>
<span><span class="va">roving_with_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">roving_no_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span>,</span>
<span>  <span class="va">roving_with_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"30 min"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate truncation
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1    30           1.98           1.77 0.329 0.289      2.15 None
2    27           1.97           1.67 0.334 0.281      2.15 30 min    </code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="monte-carlo-simulation" id="monte-carlo-simulation">
Monte Carlo Simulation
<a class="anchor" aria-label="anchor" href="#monte-carlo-simulation"></a>
</h4>
<p>
Run 1000 replications to assess bias and precision.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb23" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                           <span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                           <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                           <span class="va">interview_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"access"</span>, <span class="st">"roving"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">interview_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">interview_type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate population</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="va">n_anglers</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Sample based on design</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">interview_type</span> <span class="op">==</span> <span class="st">"access"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">completed_catch</span>, effort <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Calculate estimators</span></span>
<span>    <span class="co"># No truncation</span></span>
<span>    <span class="va">r1_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="va">r2_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># With truncation (30 min = 0.5 hr)</span></span>
<span>    <span class="va">trunc_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      rep <span class="op">=</span> <span class="va">rep</span>,</span>
<span>      true_rate <span class="op">=</span> <span class="va">true_rate</span>,</span>
<span>      r1_no_trunc <span class="op">=</span> <span class="va">r1_no</span>,</span>
<span>      r2_no_trunc <span class="op">=</span> <span class="va">r2_no</span>,</span>
<span>      r1_with_trunc <span class="op">=</span> <span class="va">r1_trunc</span>,</span>
<span>      r2_with_trunc <span class="op">=</span> <span class="va">r2_trunc</span>,</span>
<span>      n_interviews <span class="op">=</span> <span class="va">n_interviews</span>,</span>
<span>      n_after_trunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">interview_type</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run simulations</span></span>
<span><span class="va">access_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"access"</span><span class="op">)</span></span>
<span><span class="va">roving_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"roving"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="results-access-point-design" id="results-access-point-design">
Results: Access Point Design
<a class="anchor" aria-label="anchor" href="#results-access-point-design"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb24" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">access_summary</span> <span class="op">&lt;-</span> <span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Ratio of means (R1)</span></span>
<span>    r1_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span>    r1_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r1_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Mean of ratios (R2)</span></span>
<span>    r2_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>    r2_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r2_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">access_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"metric"</span><span class="op">)</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, values_to <span class="op">=</span> <span class="st">"value"</span>, names_repair <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct</span>, <span class="va">se</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pct_bias <span class="op">=</span> <span class="va">pct</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Access Point Design: Estimator Performance"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Access Point Design: Estimator Performance
</caption>
<thead><tr class="header">
<th style="text-align: left;">
estimator
</th>
<th style="text-align: right;">
mean
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
<th style="text-align: right;">
se
</th>
<th style="text-align: right;">
rmse
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
r1
</td>
<td style="text-align: right;">
1.9953
</td>
<td style="text-align: right;">
-0.0069
</td>
<td style="text-align: right;">
-0.3452
</td>
<td style="text-align: right;">
0.4276
</td>
<td style="text-align: right;">
0.4274
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
r2
</td>
<td style="text-align: right;">
2.0081
</td>
<td style="text-align: right;">
0.0059
</td>
<td style="text-align: right;">
0.2955
</td>
<td style="text-align: right;">
0.4081
</td>
<td style="text-align: right;">
0.4079
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Key Finding:</strong> For access interviews, <strong>both estimators are approximately unbiased</strong>, but ratio-of-means (R₁) typically has slightly lower variance.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb25" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>,</span>
<span>                            r1_no_trunc <span class="op">=</span> <span class="st">"Ratio of Means (R₁)"</span>,</span>
<span>                            r2_no_trunc <span class="op">=</span> <span class="st">"Mean of Ratios (R₂)"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">estimator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">estimator</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Access Point Design: Sampling Distribution"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Dashed line = true population catch rate"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Estimated Catch Rate (fish/hour)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p>
<img class="img-fluid figure-img" src="ratio-estimators-guide_files/figure-html/access-plot-1.png" width="768"></p>
<figcaption>
Access Point Design: Distribution of Estimates. Both estimators center on the true value (dashed line), demonstrating unbiasedness. The ratio-of-means (R₁) shows slightly tighter clustering, indicating lower variance.
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="results-roving-design" id="results-roving-design">
Results: Roving Design
<a class="anchor" aria-label="anchor" href="#results-roving-design"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb26" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">roving_summary</span> <span class="op">&lt;-</span> <span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 no truncation</span></span>
<span>    r1_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 no truncation</span></span>
<span>    r2_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 with truncation</span></span>
<span>    r1_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 with truncation</span></span>
<span>    r2_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">roving_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"truncation"</span>, <span class="st">"metric"</span><span class="op">)</span>,</span>
<span>               names_pattern <span class="op">=</span> <span class="st">"([^_]+)_([^_]+)_(.*)"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>, r1 <span class="op">=</span> <span class="st">"Ratio of Means"</span>, r2 <span class="op">=</span> <span class="st">"Mean of Ratios"</span><span class="op">)</span>,</span>
<span>         truncation <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">truncation</span>, no <span class="op">=</span> <span class="st">"No truncation"</span>, trunc <span class="op">=</span> <span class="st">"30-min truncation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">truncation</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct_bias</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Roving Design: Estimator Performance"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Roving Design: Estimator Performance
</caption>
<thead><tr class="header">
<th style="text-align: left;">
estimator
</th>
<th style="text-align: left;">
truncation
</th>
<th style="text-align: right;">
mean
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
<th style="text-align: right;">
rmse
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
Ratio of Means
</td>
<td style="text-align: left;">
No truncation
</td>
<td style="text-align: right;">
1.9957
</td>
<td style="text-align: right;">
-0.0209
</td>
<td style="text-align: right;">
-1.0341
</td>
<td style="text-align: right;">
0.4985
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
Mean of Ratios
</td>
<td style="text-align: left;">
No truncation
</td>
<td style="text-align: right;">
1.9909
</td>
<td style="text-align: right;">
-0.0256
</td>
<td style="text-align: right;">
-1.2698
</td>
<td style="text-align: right;">
0.4629
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">
Ratio of Means
</td>
<td style="text-align: left;">
30-min truncation
</td>
<td style="text-align: right;">
1.9966
</td>
<td style="text-align: right;">
-0.0199
</td>
<td style="text-align: right;">
-0.9880
</td>
<td style="text-align: right;">
0.5041
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
Mean of Ratios
</td>
<td style="text-align: left;">
30-min truncation
</td>
<td style="text-align: right;">
2.0092
</td>
<td style="text-align: right;">
-0.0073
</td>
<td style="text-align: right;">
-0.3629
</td>
<td style="text-align: right;">
0.4400
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Key Findings:</strong>
</p>
<ol type="1">
<li>
<strong>R₁ (ratio-of-means) is BIASED for roving interviews</strong> - does not estimate population catch rate
</li>
<li>
<strong>R₂ (mean-of-ratios) without truncation is approximately unbiased BUT has high variance</strong> (unstable)
</li>
<li>
<strong>R₂ with truncation is approximately unbiased AND has lower variance</strong> ✓ <strong>RECOMMENDED</strong>
</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb27" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span>, <span class="va">r1_with_trunc</span>, <span class="va">r2_with_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    estimator_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="va">estimator</span><span class="op">)</span>, <span class="st">"Ratio of Means (R₁)"</span>, <span class="st">"Mean of Ratios (R₂)"</span><span class="op">)</span>,</span>
<span>    truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"no_trunc"</span>, <span class="va">estimator</span><span class="op">)</span>, <span class="st">"No Truncation"</span>, <span class="st">"30-Min Truncation"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">truncation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">estimator_type</span> <span class="op">~</span> <span class="va">truncation</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Roving Design: Impact of Estimator Choice and Truncation"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Dashed line = true population catch rate"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Estimated Catch Rate (fish/hour)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Truncation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p>
<img class="img-fluid figure-img" src="ratio-estimators-guide_files/figure-html/roving-plot-1.png" width="768"></p>
<figcaption>
Roving Design: Effect of Truncation. R₁ (ratio-of-means) is biased for roving surveys regardless of truncation. R₂ (mean-of-ratios) is unbiased but has high variance without truncation; truncation reduces variance while maintaining unbiasedness.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="practical-implementation-with-tidycreel" id="practical-implementation-with-tidycreel">
Practical Implementation with tidycreel
<a class="anchor" aria-label="anchor" href="#practical-implementation-with-tidycreel"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-survey-example" id="access-point-survey-example">
Access Point Survey Example
<a class="anchor" aria-label="anchor" href="#access-point-survey-example"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb28" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have complete-trip interview data</span></span>
<span><span class="va">interviews_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">4</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_interviews</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_complete</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use RATIO-OF-MEANS (default and recommended)</span></span>
<span><span class="va">cpue_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_interviews</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"ratio_of_means"</span>  <span class="co"># ✓ Correct for access interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_access</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-survey-example" id="roving-survey-example">
Roving Survey Example
<a class="anchor" aria-label="anchor" href="#roving-survey-example"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb29" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have incomplete-trip interview data</span></span>
<span><span class="va">interviews_incomplete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,  <span class="co"># Catch so far</span></span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, min <span class="op">=</span> <span class="fl">0.2</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,  <span class="co"># Time so far</span></span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORTANT: Truncate short trips before analysis</span></span>
<span><span class="va">interviews_truncated</span> <span class="op">&lt;-</span> <span class="va">interviews_incomplete</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">hours_fished</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Remove trips &lt; 30 minutes</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_roving</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_truncated</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use MEAN-OF-RATIOS for roving interviews</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_roving</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span>  <span class="co"># ✓ Correct for roving interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_roving</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="variance-estimation" id="variance-estimation">
Variance Estimation
<a class="anchor" aria-label="anchor" href="#variance-estimation"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-ratio-of-means" id="access-point-ratio-of-means">
Access Point (Ratio-of-Means)
<a class="anchor" aria-label="anchor" href="#access-point-ratio-of-means"></a>
</h4>
<p>
For ratio-of-means with survey weights, the <code>survey</code> package automatically uses the delta method:
</p>
<p>
<strong>Note:</strong> These variance formulas assume sampling from an infinite (or very large) population. If your sample size is substantial relative to the total number of anglers (n/N &gt; 5%), you may want to apply a finite population correction (FPC): multiply the variance by (1 - n/N). However, for most creel surveys where the population of potential anglers is large, this correction is negligible.
</p>
<p>
<span class="math display">[(_1) (C - _1 E)]</span>
</p>
<p>
where <span class="math inline">(C)</span> = catch, <span class="math inline">(E)</span> = effort.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb30" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># survey::svyratio() provides proper variance</span></span>
<span><span class="va">cpue_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_interviews</span>, mode <span class="op">=</span> <span class="st">"ratio_of_means"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error is included</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">se</span></span>
<span></span>
<span><span class="co"># 95% confidence interval</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-mean-of-ratios-with-truncation" id="roving-mean-of-ratios-with-truncation">
Roving (Mean-of-Ratios with Truncation)
<a class="anchor" aria-label="anchor" href="#roving-mean-of-ratios-with-truncation"></a>
</h4>
<p>
For mean-of-ratios, variance is straightforward:
</p>
<p>
<span class="math display">[(_2) = ()]</span>
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb31" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># survey::svymean() on the ratio variable</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_roving</span>, mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error and CIs included</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">se</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="special-considerations" id="special-considerations">
Special Considerations
<a class="anchor" aria-label="anchor" href="#special-considerations"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="bag-limits" id="bag-limits">
Bag Limits
<a class="anchor" aria-label="anchor" href="#bag-limits"></a>
</h4>
<p>
<strong>⚠️ CRITICAL WARNING:</strong> Roving surveys can produce <strong>severe negative bias</strong> (underestimation of 20-50%+) when bag limits are low (≤5 fish) and anglers comply by leaving immediately upon reaching the limit.
</p>
<p>
<strong>Problem:</strong> If anglers leave immediately after catching their limit, the roving clerk will encounter <strong>only unsuccessful anglers</strong>, leading to severe underestimation.
</p>
<p>
<strong>Example simulation</strong> (bag limit = 2 fish):
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb32" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulate_with_bag_limit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">bag_limit</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simulate fishing day</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Apply bag limit: anglers stop when limit reached</span></span>
<span>    <span class="va">day_limited</span> <span class="op">&lt;-</span> <span class="va">day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="co"># Time to reach bag limit (exponential waiting time)</span></span>
<span>        time_to_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">catch_rate_true</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                               <span class="va">bag_limit</span> <span class="op">/</span> <span class="va">catch_rate_true</span>,</span>
<span>                               <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual trip length (stop at limit or planned end, whichever comes first)</span></span>
<span>        actual_trip_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_length</span>, <span class="va">time_to_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual catch (capped at bag limit)</span></span>
<span>        actual_catch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">completed_catch</span>, <span class="va">bag_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Did angler reach bag limit before planned trip end?</span></span>
<span>        reached_limit <span class="op">=</span> <span class="op">(</span><span class="va">time_to_limit</span> <span class="op">&lt;</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Roving interviews can only encounter anglers still on-site</span></span>
<span>    <span class="co"># Those who reached bag limit before their planned trip end have already left</span></span>
<span>    <span class="co"># Only those who haven't reached the limit OR reached it at/after planned end are available</span></span>
<span>    <span class="va">still_fishing</span> <span class="op">&lt;-</span> <span class="va">day_limited</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">reached_limit</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">still_fishing</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Sample from those still fishing</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">still_fishing</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="va">r2</span>,</span>
<span>                     bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="cn">NA</span>, bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bag_limit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op">&lt;-</span> <span class="va">bag_limit_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">bag_limit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    mean_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span>,</span>
<span>    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Roving Bias Under Different Bag Limits"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Roving Bias Under Different Bag Limits
</caption>
<thead><tr class="header">
<th style="text-align: right;">
bag_limit
</th>
<th style="text-align: right;">
true_rate
</th>
<th style="text-align: right;">
mean_estimate
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">
2
</td>
<td style="text-align: right;">
2.010
</td>
<td style="text-align: right;">
0.341
</td>
<td style="text-align: right;">
-1.668
</td>
<td style="text-align: right;">
-83.017
</td>
</tr>
<tr class="even">
<td style="text-align: right;">
5
</td>
<td style="text-align: right;">
2.001
</td>
<td style="text-align: right;">
0.655
</td>
<td style="text-align: right;">
-1.346
</td>
<td style="text-align: right;">
-67.286
</td>
</tr>
<tr class="odd">
<td style="text-align: right;">
10
</td>
<td style="text-align: right;">
2.003
</td>
<td style="text-align: right;">
1.021
</td>
<td style="text-align: right;">
-0.982
</td>
<td style="text-align: right;">
-49.014
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Recommendation:</strong> If bag limits are low (≤5 fish) and compliance is high, <strong>use access point interviews</strong> instead of roving.
</p>
</section><section class="level3"><h4 class="anchored" data-anchor-id="nonstationary-catch-rates" id="nonstationary-catch-rates">
Nonstationary Catch Rates
<a class="anchor" aria-label="anchor" href="#nonstationary-catch-rates"></a>
</h4>
<p>
If catch rates change systematically during trips (e.g., learning curve, time-of-day effects), roving interviews may be biased.
</p>
<p>
<strong>Check this by:</strong>
</p>
<ol type="1">
<li>
Comparing incomplete-trip catch rates to complete-trip catch rates
</li>
<li>
Looking for patterns in catch rate vs. time-of-day
</li>
</ol>
<p>
<strong>If nonstationary:</strong> Consider access point interviews or model the time-varying catch rate.
</p>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="summary-practical-guidelines" id="summary-practical-guidelines">
Summary: Practical Guidelines
<a class="anchor" aria-label="anchor" href="#summary-practical-guidelines"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="decision-rules" id="decision-rules">
Decision Rules
<a class="anchor" aria-label="anchor" href="#decision-rules"></a>
</h4>
<table class="table caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 24%">
<col style="width: 33%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>
Survey Type
</th>
<th>
Interview Type
</th>
<th>
Recommended Estimator
</th>
<th>
Function Call
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
Access point
</td>
<td>
Complete trips
</td>
<td>
Ratio-of-means (R₁)
</td>
<td>
<code>est_cpue(…, mode = “ratio_of_means”)</code>
</td>
</tr>
<tr class="even">
<td>
Roving
</td>
<td>
Incomplete trips
</td>
<td>
Mean-of-ratios (R₂) with truncation
</td>
<td>
<code>est_cpue(…, mode = “mean_of_ratios”)</code> + filter short trips
</td>
</tr>
<tr class="odd">
<td>
Complemented (aerial-access)
</td>
<td>
Complete trips
</td>
<td>
Ratio-of-means (R₁)
</td>
<td>
<code>est_cpue(…, mode = “ratio_of_means”)</code>
</td>
</tr>
<tr class="even">
<td>
Complemented (aerial-roving)
</td>
<td>
Incomplete trips
</td>
<td>
Mean-of-ratios (R₂) with truncation
</td>
<td>
<code>est_cpue(…, mode = “mean_of_ratios”)</code> + filter
</td>
</tr>
</tbody>
</table></section><section class="level3"><h4 class="anchored" data-anchor-id="pre-processing-checklist" id="pre-processing-checklist">
Pre-processing Checklist
<a class="anchor" aria-label="anchor" href="#pre-processing-checklist"></a>
</h4>
<p>
<strong>For ALL surveys:</strong>
</p>
<ul class="task-list">
<li>
<label><input type="checkbox">Check for missing data in catch and effort</label>
</li>
<li>
<label><input type="checkbox">Verify effort &gt; 0 for all interviews</label>
</li>
<li>
<label><input type="checkbox">Check for outliers (data entry errors)</label>
</li>
</ul>
<p>
<strong>For ROVING surveys specifically:</strong>
</p>
<ul class="task-list">
<li>
<label><input type="checkbox">Truncate short trips (&lt; 20-30 minutes)</label>
</li>
<li>
<label><input type="checkbox">Check bag limit compliance (may cause bias)</label>
</li>
<li>
<label><input type="checkbox">Verify catch rate stationarity (if possible)</label>
</li>
</ul></section><section class="level3"><h4 class="anchored" data-anchor-id="variance-estimation-checklist" id="variance-estimation-checklist">
Variance Estimation Checklist
<a class="anchor" aria-label="anchor" href="#variance-estimation-checklist"></a>
</h4>
<ul class="task-list">
<li>
<label><input type="checkbox">Use proper survey weights in <code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign()</a></code></label>
</li>
<li>
<label><input type="checkbox">Include stratification variables</label>
</li>
<li>
<label><input type="checkbox">Use <code><a href="https://rdrr.io/pkg/survey/man/svyratio.html" class="external-link">svyratio()</a></code> for ratio-of-means</label>
</li>
<li>
<label><input type="checkbox">Use <code><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean()</a></code> on catch/effort ratio for mean-of-ratios</label>
</li>
<li>
<label><input type="checkbox">Report standard errors and confidence intervals</label>
</li>
</ul></section></section><section class="section level3"><h3 class="anchored" data-anchor-id="references" id="references">
References
<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>
<p>
<strong>Pollock, K.H., Hoenig, J.M., Jones, C.M., Robson, D.S., &amp; Greene, C.J. (1997).</strong> Catch rate estimation for roving and access point surveys. <em>North American Journal of Fisheries Management</em>, 17(1), 11-19.
</p>
</li>
<li>
<p>
<strong>Rasmussen, P.W., Staggs, M.D., Beard, T.D., &amp; Newman, S.P. (1998).</strong> Bias and confidence interval coverage of creel survey estimators evaluated by simulation. <em>Transactions of the American Fisheries Society</em>, 127(3), 469-480.
</p>
</li>
<li>
<p>
<strong>Jones, C.M., Robson, D.S., Lakkis, H.D., &amp; Kressel, J. (1995).</strong> Properties of catch rates used in analysis of angler surveys. <em>Transactions of the American Fisheries Society</em>, 124(6), 911-928.
</p>
</li>
<li>
<p>
<strong>Lumley, T. (2004).</strong> Analysis of complex survey samples. <em>Journal of Statistical Software</em>, 9(1), 1-19.
</p>
</li>
</ul></section><section class="section level3"><h3 class="anchored" data-anchor-id="conclusion" id="conclusion">
Conclusion
<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>
The choice between ratio-of-means and mean-of-ratios depends fundamentally on your <strong>survey design</strong>:
</p>
<ul>
<li>
<strong>Access point interviews</strong> → Use <strong>ratio-of-means</strong>
</li>
<li>
<strong>Roving interviews</strong> → Use <strong>mean-of-ratios with truncation</strong>
</li>
</ul>
<p>
The <code>tidycreel</code> package implements both estimators with proper variance estimation through the <code>survey</code> package. By following the decision rules in this vignette, you can ensure your catch rate estimates are unbiased and your confidence intervals have correct coverage.
</p>
</section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button,
          { trigger: "manual",
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined;
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              }
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            }
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div>
<!-- /content -->

<header class="quarto-title-block default" id="title-block-header"><div class="quarto-title">
<h1 class="title">
Ratio Estimators: When to Use Ratio-of-Means vs Mean-of-Ratios
</h1>
</div>
<div class="quarto-title-meta">

</div>
</header><div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb1" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/" class="external-link">survey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Try to load tidycreel if available (for the practical examples)</span></span>
<span><span class="co"># The simulations work without it</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"tidycreel"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chrischizinski/tidycreel" class="external-link">tidycreel</a></span><span class="op">)</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">has_tidycreel</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Note: tidycreel not installed. Practical examples will not run, but simulations will work."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
<section class="section level3"><h3 class="anchored" data-anchor-id="introduction" id="introduction-1">
Introduction
<a class="anchor" aria-label="anchor" href="#introduction-1"></a>
</h3>
<p>
One of the most common questions in creel survey analysis is: <strong>“Should I use ratio-of-means or mean-of-ratios to estimate catch rate?”</strong>
</p>
<p>
This vignette answers that question through:
</p>
<ol type="1">
<li>
<strong>Decision rules</strong> based on survey design type
</li>
<li>
<strong>Simulation demonstrations</strong> showing estimator performance
</li>
<li>
<strong>Practical guidance</strong> on variance estimation
</li>
<li>
<strong>Clear examples</strong> using <code>tidycreel</code>
</li>
</ol></section><section class="section level3"><h3 class="anchored" data-anchor-id="quick-answer-decision-tree" id="quick-answer-decision-tree-1">
Quick Answer: Decision Tree
<a class="anchor" aria-label="anchor" href="#quick-answer-decision-tree-1"></a>
</h3>
<pre><code>┌─────────────────────────────────────────────┐
│   What type of interviews do you have?      │
└─────────────────┬───────────────────────────┘
                  │
        ┌─────────┴─────────┐
        │                   │
    ┌───▼──────┐          ┌───▼────────┐
    │ ACCESS   │          │ ROVING     │
    │(Complete │          │(Incomplete │
    │ trips)   │          │  trips)    │
    └───┬──────┘          └───┬────────┘
        │                     │
        │                     │
    ┌───▼─────────────────┐   │
    │ Use RATIO-OF-MEANS  │   │
    │  R₁ = Σcatch/Σeffort│   │
    │                     │   │
    │ Why? Each angler    │   │
    │ has equal sampling  │   │
    │ probability.        │   │
    │                     │   │
    │ ✓ Unbiased          │   │
    │ ✓ Finite variance   │   │
    └─────────────────────┘   │
                              │
                  ┌───────────▼────────────────┐
                  │ Use MEAN-OF-RATIOS         │
                  │  R₂ = (1/n)Σ(catch/effort) │
                  │                            │
                  │ IMPORTANT: Truncate short  │
                  │ trips (&lt; 20-30 minutes)    │
                  │                            │
                  │ Why? Sampling probability  │
                  │ ∝ trip length. R₁ would    │
                  │ give biased estimate.      │
                  │                            │
                  │ ⚠ Avoid if bag limits      │
                  │   are low &amp; easily obtained│
                  └────────────────────────────┘</code></pre>
</section><section class="section level3"><h3 class="anchored" data-anchor-id="theoretical-background" id="theoretical-background-1">
Theoretical Background
<a class="anchor" aria-label="anchor" href="#theoretical-background-1"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-complete-trip-interviews" id="access-point-complete-trip-interviews-1">
Access Point (Complete Trip) Interviews
<a class="anchor" aria-label="anchor" href="#access-point-complete-trip-interviews-1"></a>
</h4>
<p>
<strong>Sampling Design:</strong>
</p>
<ul>
<li>
Interviews conducted as anglers <strong>complete</strong> their trips
</li>
<li>
All anglers have <strong>equal probability</strong> of being interviewed
</li>
<li>
P(interviewed) = constant, regardless of trip length
</li>
</ul>
<p>
<strong>Appropriate Estimator: Ratio-of-Means (R₁)</strong>
</p>
<p>
<span class="math display">[_1 = ]</span>
</p>
<p>
where <span class="math inline">(C_j^<em>)</em></span><em> = total catch for the <strong>completed trip</strong> and <span class="math inline">(L_j^</span></em>) = total trip length <strong>at completion</strong>.
</p>
<p>
<strong>Expected Value:</strong> <span class="math display">[E(_1) ]</span>
</p>
<p>
✓ <strong>This is what we want for total catch estimation!</strong>
</p>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-incomplete-trip-interviews" id="roving-incomplete-trip-interviews-1">
Roving (Incomplete Trip) Interviews
<a class="anchor" aria-label="anchor" href="#roving-incomplete-trip-interviews-1"></a>
</h4>
<p>
<strong>Sampling Design:</strong>
</p>
<ul>
<li>
Interviews conducted <strong>during</strong> fishing trips
</li>
<li>
Sampling probability <strong>∝ trip length</strong>
</li>
<li>
Longer trips are more likely to be encountered
</li>
</ul>
<p>
<strong>Appropriate Estimator: Mean-of-Ratios (R₂) with Truncation</strong>
</p>
<p>
<span class="math display">[<em>2 = </em>{j=1}^{n} ]</span>
</p>
<p>
where <span class="math inline">(C_j)</span> = catch <strong>at time of interview</strong> and <span class="math inline">(L_j)</span> = elapsed time <strong>at interview</strong>.
</p>
<p>
<strong>With truncation:</strong> Only include interviews where <span class="math inline">(L_j &gt; L_{min})</span> (typically 20-30 minutes).
</p>
<p>
<strong>Expected Value:</strong> <span class="math display">[E(_2) ]</span>
</p>
<p>
✓ <strong>Correct for roving interviews!</strong>
</p>
<p>
<strong>Why NOT use R₁ for roving?</strong>
</p>
<p>
The ratio-of-means for roving interviews has: <span class="math display">[E(_1^{roving}) ]</span>
</p>
<p>
This is a <strong>weighted average</strong> with weights = (trip length)², which does <strong>not</strong> estimate the population catch rate!
</p>
</section><section class="level2"><h3 class="anchored" id="handling-mixed-complete-and-incomplete-trips-8">
Handling Mixed Complete and Incomplete Trips
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-8"></a>
</h3>
<p>
<strong>Why this matters:</strong> Real creel surveys often produce a mix of <em>completed</em> (access-point) and <em>incomplete</em> (roving/intercept) interviews. Estimator choice must follow the <strong>inclusion probability</strong>, not just trip status, to avoid bias.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-9">
Principle
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-9"></a>
</h4>
<p>
When inclusion probability differs by design (equal-probability at access points vs. length-biased in roving), pooling interviews and applying a single estimator can introduce bias. Treat designs according to their sampling properties.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-10">
1️⃣ Separate Estimation (Recommended)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-10"></a>
</h4>
<p>
Treat complete and incomplete interviews as two strata, then combine by <strong>effort weighting</strong>:
</p>
<ul>
<li>
<strong>Complete trips (access point):</strong> use <em>Ratio-of-Means</em> (R₁ = ΣC / ΣE).
</li>
<li>
<strong>Incomplete trips (roving):</strong> use <em>Mean-of-Ratios</em> (R₂ = (1/n) Σ(C/E)) with <strong>truncation</strong> of short trips (e.g., &lt; 20–30 min).
</li>
</ul>
<p>
<strong>Effort-weighted combination:</strong>
</p>
<p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">combined</mtext></msub><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mn>1</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>R</mi><mn>2</mn></msub><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow><mrow><msub><mi>E</mi><mtext mathvariant="normal">complete</mtext></msub><mo>+</mo><msub><mi>E</mi><mtext mathvariant="normal">incomplete</mtext></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{combined}} = \frac{R_1 E_{\text{complete}} + R_2 E_{\text{incomplete}}}{E_{\text{complete}} + E_{\text{incomplete}}}
</annotation></semantics></math></p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-11">
2️⃣ Model-Based Weighting (optional)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-11"></a>
</h4>
<p>
If you can estimate selection/inclusion probabilities (e.g., a model for trip completeness or roving intercept likelihood), use a weighted ratio:
</p>
<p>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>R</mi><mo accent="true">̂</mo></mover><mtext mathvariant="normal">weighted</mtext></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>C</mi><mi>i</mi></msub></mrow><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>E</mi><mi>i</mi></msub></mrow></mfrac><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mtext mathvariant="normal">select</mtext><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\hat{R}_{\text{weighted}} = \frac{\sum_i w_i C_i}{\sum_i w_i E_i}, \quad w_i = 1 / P(\text{select}_i).
</annotation></semantics></math></p>
<p>
This is useful for hybrid designs where sampling varies predictably across modes, times, or sites.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-12">
3️⃣ Sensitivity Analysis
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-12"></a>
</h4>
<p>
Compute: (a) R₁ on complete only, (b) R₂ on incomplete (with truncation), and (c) the combined estimator. If differences are small (e.g., &lt; 5–10%), pooling assumptions may be reasonable; document them.
</p>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-13">
Cautions
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-13"></a>
</h4>
<ul>
<li>
Do <strong>not</strong> apply R₁ to unfiltered roving data — it is biased high due to length-biased sampling.
</li>
<li>
Do <strong>not</strong> apply R₂ to complete trips only — bias direction depends on effort variability.
</li>
<li>
Always truncate short incomplete trips to stabilize R₂ and reduce small-denominator issues.
</li>
<li>
When bag limits are frequently hit, be cautious with R₂ (ceiling effects can distort ratios).
</li>
</ul>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-14">
Implementation sketch (R)
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-14"></a>
</h4>
<pre><code class="language-r"><span><span class="va">complete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">incomplete</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_complete</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># 0.5 h = 30 min</span></span>
<span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">incomplete</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R_combined</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">r1</span> <span class="op">*</span> <span class="va">E1</span> <span class="op">+</span> <span class="va">r2</span> <span class="op">*</span> <span class="va">E2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">E1</span> <span class="op">+</span> <span class="va">E2</span><span class="op">)</span></span></code></pre>
<h4 class="anchored" id="handling-mixed-complete-and-incomplete-trips-15">
Variance note
<a class="anchor" aria-label="anchor" href="#handling-mixed-complete-and-incomplete-trips-15"></a>
</h4>
<p>
Estimate SEs for each stratum with the appropriate formula (delta-method for R₁; sample variance of ratios for R₂), then combine via delta-method using the effort-weight combination above.
</p>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="simulation-study" id="simulation-study-1">
Simulation Study
<a class="anchor" aria-label="anchor" href="#simulation-study-1"></a>
</h3>
<p>
The theoretical results above show <strong>why</strong> estimator choice matters. But how large is the bias in practice? And does truncation really help?
</p>
<p>
Let’s demonstrate these principles through simulation, following the approach of Rasmussen et al. (1998) and Pollock et al. (1997).
</p>
<section class="level3"><h4 class="anchored" data-anchor-id="simulation-setup" id="simulation-setup-1">
Simulation Setup
<a class="anchor" aria-label="anchor" href="#simulation-setup-1"></a>
</h4>
<p>
We’ll simulate a realistic fishing scenario and compare estimator performance.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb3" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate a day of fishing with known parameters</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param n_anglers Number of anglers fishing during the day</span></span>
<span><span class="co">#' @param mean_trip_hours Mean trip length (hours)</span></span>
<span><span class="co">#' @param mean_catch_rate Mean catch per hour (Poisson rate parameter)</span></span>
<span><span class="co">#' @param day_length_hours Length of fishing day</span></span>
<span><span class="co">#' @return List with population parameters and individual angler data</span></span>
<span><span class="va">simulate_fishing_day</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                 <span class="va">mean_trip_hours</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                 <span class="va">mean_catch_rate</span> <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                 <span class="va">day_length_hours</span> <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Each angler's true catch rate (gamma-distributed for heterogeneity)</span></span>
<span>  <span class="co"># Shape = 1, rate = 1/mean gives exponential with specified mean</span></span>
<span>  <span class="co"># This creates variation in angler skill/success</span></span>
<span>  <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">mean_catch_rate</span></span>
<span>  <span class="va">catch_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">alpha</span>, rate <span class="op">=</span> <span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Trip lengths (gamma-distributed)</span></span>
<span>  <span class="va">shape_trip</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co"># Controls variability</span></span>
<span>  <span class="va">rate_trip</span> <span class="op">&lt;-</span> <span class="va">shape_trip</span> <span class="op">/</span> <span class="va">mean_trip_hours</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_anglers</span>, shape <span class="op">=</span> <span class="va">shape_trip</span>, rate <span class="op">=</span> <span class="va">rate_trip</span><span class="op">)</span></span>
<span>  <span class="va">trip_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_lengths</span>, <span class="va">day_length_hours</span><span class="op">)</span>  <span class="co"># Can't exceed day length</span></span>
<span></span>
<span>  <span class="co"># Generate catches for each angler (Poisson process)</span></span>
<span>  <span class="co"># Expected catch = catch_rate * trip_length</span></span>
<span>  <span class="va">completed_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_anglers</span>, lambda <span class="op">=</span> <span class="va">catch_rates</span> <span class="op">*</span> <span class="va">trip_lengths</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># True population parameters</span></span>
<span>  <span class="va">total_effort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trip_lengths</span><span class="op">)</span></span>
<span>  <span class="va">total_catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">completed_catch</span><span class="op">)</span></span>
<span>  <span class="va">true_catch_rate</span> <span class="op">&lt;-</span> <span class="va">total_catch</span> <span class="op">/</span> <span class="va">total_effort</span></span>
<span></span>
<span>  <span class="co"># Return angler-level data</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_anglers</span>,</span>
<span>    catch_rate_true <span class="op">=</span> <span class="va">catch_rates</span>,</span>
<span>    trip_length <span class="op">=</span> <span class="va">trip_lengths</span>,</span>
<span>    completed_catch <span class="op">=</span> <span class="va">completed_catch</span>,</span>
<span>    true_population_rate <span class="op">=</span> <span class="va">true_catch_rate</span>,</span>
<span>    total_effort <span class="op">=</span> <span class="va">total_effort</span>,</span>
<span>    total_catch <span class="op">=</span> <span class="va">total_catch</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example</span></span>
<span><span class="va">fishing_day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  angler_id catch_rate_true trip_length completed_catch true_population_rate
      &lt;int&gt;           &lt;dbl&gt;       &lt;dbl&gt;           &lt;int&gt;                &lt;dbl&gt;
1         1           2.00         4.78               7                 2.15
2         2           2.26         1.56               5                 2.15
3         3           0.851        4.74               4                 2.15
4         4           1.03         6.06               5                 2.15
5         5           6.96         4.52              35                 2.15
6         6           0.627        5.59               3                 2.15
# ℹ 2 more variables: total_effort &lt;dbl&gt;, total_catch &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb5" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary of true population parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True Population Parameters:\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>True Population Parameters:</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb7" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total anglers:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total anglers: 100 </code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb9" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total effort:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">total_effort</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"hours\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total effort: 391.8 hours</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb11" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Total catch:"</span>, <span class="va">fishing_day</span><span class="op">$</span><span class="va">total_catch</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"fish\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total catch: 844 fish</code></pre>
</div>
<div class="code-copy-outer-scaffold">
<div id="cb13" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  True catch rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"fish/hour\n"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  True catch rate: 2.154 fish/hour</code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="scenario-1-access-point-interviews-complete-trips" id="scenario-1-access-point-interviews-complete-trips-1">
Scenario 1: Access Point Interviews (Complete Trips)
<a class="anchor" aria-label="anchor" href="#scenario-1-access-point-interviews-complete-trips-1"></a>
</h4>
<p>
Simulate a traditional access point creel where we interview anglers as they finish.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb15" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate access point interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Number of interviews to conduct</span></span>
<span><span class="co">#' @return Tibble with interview data</span></span>
<span><span class="va">sample_access_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Simple random sample (equal probability)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Single realization</span></span>
<span><span class="va">access_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  angler_id completed_catch trip_length true_population_rate
      &lt;int&gt;           &lt;int&gt;       &lt;dbl&gt;                &lt;dbl&gt;
1         1               7        4.78                 2.15
2        69               4        5.05                 2.15
3        79              14        6.27                 2.15
4        19               5        6.75                 2.15
5        12               1        4.72                 2.15
6        64               0        5.88                 2.15</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb17" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate both estimators</span></span>
<span><span class="va">calculate_estimates</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">interviews</span>, <span class="va">truncate_minutes</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Apply truncation if specified (for roving surveys)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">truncate_minutes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">interviews</span> <span class="op">&lt;-</span> <span class="va">interviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">trip_length</span> <span class="op">&gt;=</span> <span class="va">truncate_minutes</span> <span class="op">/</span> <span class="fl">60</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Ratio-of-means</span></span>
<span>  <span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Mean-of-ratios</span></span>
<span>  <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Variance estimates (simplified)</span></span>
<span>  <span class="co"># For R1: use delta method (Taylor series approximation)</span></span>
<span>  <span class="co"># Var(R₁) ≈ (1/n·E̅²) · Var(C - R₁·E)</span></span>
<span>  <span class="co"># where residual = catch - estimated_rate × effort</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span></span>
<span>  <span class="va">e</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">r_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">e_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">var_r1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">e_bar</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="va">r1</span> <span class="op">*</span> <span class="va">e</span><span class="op">)</span></span>
<span>  <span class="va">se_r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># For R2: simple variance of the ratios</span></span>
<span>  <span class="va">ratios</span> <span class="op">&lt;-</span> <span class="va">interviews</span><span class="op">$</span><span class="va">completed_catch</span> <span class="op">/</span> <span class="va">interviews</span><span class="op">$</span><span class="va">trip_length</span></span>
<span>  <span class="va">var_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">ratios</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span>
<span>  <span class="va">se_r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">var_r2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    ratio_of_means <span class="op">=</span> <span class="va">r1</span>,</span>
<span>    mean_of_ratios <span class="op">=</span> <span class="va">r2</span>,</span>
<span>    se_r1 <span class="op">=</span> <span class="va">se_r1</span>,</span>
<span>    se_r2 <span class="op">=</span> <span class="va">se_r2</span>,</span>
<span>    true_rate <span class="op">=</span> <span class="va">interviews</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">access_results</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">access_sample</span><span class="op">)</span></span>
<span><span class="va">access_results</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1    30           2.04           2.41 0.401 0.463      2.15</code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="scenario-2-roving-interviews-incomplete-trips" id="scenario-2-roving-interviews-incomplete-trips-1">
Scenario 2: Roving Interviews (Incomplete Trips)
<a class="anchor" aria-label="anchor" href="#scenario-2-roving-interviews-incomplete-trips-1"></a>
</h4>
<p>
Now simulate roving interviews where anglers are intercepted during their trips.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb19" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Simulate roving interviews</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param fishing_day Tibble from simulate_fishing_day()</span></span>
<span><span class="co">#' @param n_interviews Target number of interviews</span></span>
<span><span class="co">#' @return Tibble with incomplete trip interview data</span></span>
<span><span class="va">sample_roving_interviews</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fishing_day</span>, <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Length-biased sampling: probability of encounter ∝ trip duration</span></span>
<span>  <span class="co"># P(interview angler i) = L_i / Σ L_j (normalized by total effort)</span></span>
<span>  <span class="co"># Longer trips have higher chance of being encountered during roving</span></span>
<span>  <span class="va">prob_intercept</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">$</span><span class="va">trip_length</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Sample with probability proportional to size</span></span>
<span>  <span class="va">sampled_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">n_interviews</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fishing_day</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    prob <span class="op">=</span> <span class="va">prob_intercept</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">fishing_day</span><span class="op">[</span><span class="va">sampled_indices</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="co"># For each intercepted angler, determine interview time</span></span>
<span>  <span class="co"># Uniform on [0, trip_length] (on average, intercepted at midpoint)</span></span>
<span>  <span class="va">sampled</span> <span class="op">&lt;-</span> <span class="va">sampled</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="co"># Time fished when interviewed (uniform on [0, trip_length])</span></span>
<span>      <span class="co"># On average, anglers are intercepted at midpoint of their trip</span></span>
<span>      time_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span>,</span>
<span></span>
<span>      <span class="co"># Catch at interview time (incomplete trip)</span></span>
<span>      <span class="co"># Poisson process: E[catch | time_t] = λ × t</span></span>
<span>      <span class="co"># where λ = angler's true catch rate, t = time fished so far</span></span>
<span>      catch_at_interview <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, lambda <span class="op">=</span> <span class="va">catch_rate_true</span> <span class="op">*</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>, <span class="va">catch_at_interview</span>, <span class="va">time_at_interview</span>,</span>
<span>           <span class="va">completed_catch</span>, <span class="va">trip_length</span>, <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">sampled</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">roving_sample</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">fishing_day</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">roving_sample</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  angler_id catch_at_interview time_at_interview completed_catch trip_length
      &lt;int&gt;              &lt;int&gt;             &lt;dbl&gt;           &lt;int&gt;       &lt;dbl&gt;
1        27                  1             2.57                2        5.27
2        37                  4             1.46               13        2.99
3        81                  0             0.326               3        3.86
4        32                  1             2.30                8        5.76
5        97                  6             3.54               10        4.81
6        28                  4             2.58                5        2.72
# ℹ 1 more variable: true_population_rate &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb21" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For roving, use incomplete data</span></span>
<span><span class="co"># Note: calculate_estimates() expects columns named 'completed_catch' and 'trip_length'</span></span>
<span><span class="va">roving_data</span> <span class="op">&lt;-</span> <span class="va">roving_sample</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">angler_id</span>,</span>
<span>         completed_catch <span class="op">=</span> <span class="va">catch_at_interview</span>,</span>
<span>         trip_length <span class="op">=</span> <span class="va">time_at_interview</span>,</span>
<span>         <span class="va">true_population_rate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># No truncation</span></span>
<span><span class="va">roving_no_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With truncation (30 minutes)</span></span>
<span><span class="va">roving_with_trunc</span> <span class="op">&lt;-</span> <span class="fu">calculate_estimates</span><span class="op">(</span><span class="va">roving_data</span>, truncate_minutes <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">roving_no_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span>,</span>
<span>  <span class="va">roving_with_trunc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>truncation <span class="op">=</span> <span class="st">"30 min"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
      n ratio_of_means mean_of_ratios se_r1 se_r2 true_rate truncation
  &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;
1    30           1.98           1.77 0.329 0.289      2.15 None
2    27           1.97           1.67 0.334 0.281      2.15 30 min    </code></pre>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="monte-carlo-simulation" id="monte-carlo-simulation-1">
Monte Carlo Simulation
<a class="anchor" aria-label="anchor" href="#monte-carlo-simulation-1"></a>
</h4>
<p>
Run 1000 replications to assess bias and precision.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb23" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                           <span class="va">n_anglers</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                           <span class="va">n_interviews</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                           <span class="va">interview_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"access"</span>, <span class="st">"roving"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">interview_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">interview_type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate population</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="va">n_anglers</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Sample based on design</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">interview_type</span> <span class="op">==</span> <span class="st">"access"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_access_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">completed_catch</span>, effort <span class="op">=</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">day</span>, <span class="va">n_interviews</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Calculate estimators</span></span>
<span>    <span class="co"># No truncation</span></span>
<span>    <span class="va">r1_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="va">r2_no</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># With truncation (30 min = 0.5 hr)</span></span>
<span>    <span class="va">trunc_data</span> <span class="op">&lt;-</span> <span class="va">sample_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">trunc_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">r1_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">r2_trunc</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      rep <span class="op">=</span> <span class="va">rep</span>,</span>
<span>      true_rate <span class="op">=</span> <span class="va">true_rate</span>,</span>
<span>      r1_no_trunc <span class="op">=</span> <span class="va">r1_no</span>,</span>
<span>      r2_no_trunc <span class="op">=</span> <span class="va">r2_no</span>,</span>
<span>      r1_with_trunc <span class="op">=</span> <span class="va">r1_trunc</span>,</span>
<span>      r2_with_trunc <span class="op">=</span> <span class="va">r2_trunc</span>,</span>
<span>      n_interviews <span class="op">=</span> <span class="va">n_interviews</span>,</span>
<span>      n_after_trunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">trunc_data</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">interview_type</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run simulations</span></span>
<span><span class="va">access_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"access"</span><span class="op">)</span></span>
<span><span class="va">roving_mc</span> <span class="op">&lt;-</span> <span class="fu">run_simulation</span><span class="op">(</span>n_reps <span class="op">=</span> <span class="fl">1000</span>, interview_type <span class="op">=</span> <span class="st">"roving"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="results-access-point-design" id="results-access-point-design-1">
Results: Access Point Design
<a class="anchor" aria-label="anchor" href="#results-access-point-design-1"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb24" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">access_summary</span> <span class="op">&lt;-</span> <span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Ratio of means (R1)</span></span>
<span>    r1_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span>    r1_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r1_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r1_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r1_no_trunc</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># Mean of ratios (R2)</span></span>
<span>    r2_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>    r2_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    r2_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    r2_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">r2_no_trunc</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">access_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>, names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"metric"</span><span class="op">)</span>, names_sep <span class="op">=</span> <span class="st">"_"</span>, values_to <span class="op">=</span> <span class="st">"value"</span>, names_repair <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct</span>, <span class="va">se</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>pct_bias <span class="op">=</span> <span class="va">pct</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Access Point Design: Estimator Performance"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Access Point Design: Estimator Performance
</caption>
<thead><tr class="header">
<th style="text-align: left;">
estimator
</th>
<th style="text-align: right;">
mean
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
<th style="text-align: right;">
se
</th>
<th style="text-align: right;">
rmse
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
r1
</td>
<td style="text-align: right;">
1.9953
</td>
<td style="text-align: right;">
-0.0069
</td>
<td style="text-align: right;">
-0.3452
</td>
<td style="text-align: right;">
0.4276
</td>
<td style="text-align: right;">
0.4274
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
r2
</td>
<td style="text-align: right;">
2.0081
</td>
<td style="text-align: right;">
0.0059
</td>
<td style="text-align: right;">
0.2955
</td>
<td style="text-align: right;">
0.4081
</td>
<td style="text-align: right;">
0.4079
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Key Finding:</strong> For access interviews, <strong>both estimators are approximately unbiased</strong>, but ratio-of-means (R₁) typically has slightly lower variance.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb25" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">access_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>,</span>
<span>                            r1_no_trunc <span class="op">=</span> <span class="st">"Ratio of Means (R₁)"</span>,</span>
<span>                            r2_no_trunc <span class="op">=</span> <span class="st">"Mean of Ratios (R₂)"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">estimator</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">estimator</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Access Point Design: Sampling Distribution"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Dashed line = true population catch rate"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Estimated Catch Rate (fish/hour)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p>
<img class="img-fluid figure-img" src="ratio-estimators-guide_files/figure-html/access-plot-1.png" width="768"></p>
<figcaption>
Access Point Design: Distribution of Estimates. Both estimators center on the true value (dashed line), demonstrating unbiasedness. The ratio-of-means (R₁) shows slightly tighter clustering, indicating lower variance.
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="results-roving-design" id="results-roving-design-1">
Results: Roving Design
<a class="anchor" aria-label="anchor" href="#results-roving-design-1"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb26" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">roving_summary</span> <span class="op">&lt;-</span> <span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 no truncation</span></span>
<span>    r1_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 no truncation</span></span>
<span>    r2_no_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_no_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_no_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R1 with truncation</span></span>
<span>    r1_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r1_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r1_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># R2 with truncation</span></span>
<span>    r2_trunc_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    r2_trunc_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">r2_with_trunc</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">roving_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">true_rate</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimator"</span>, <span class="st">"truncation"</span>, <span class="st">"metric"</span><span class="op">)</span>,</span>
<span>               names_pattern <span class="op">=</span> <span class="st">"([^_]+)_([^_]+)_(.*)"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estimator <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">estimator</span>, r1 <span class="op">=</span> <span class="st">"Ratio of Means"</span>, r2 <span class="op">=</span> <span class="st">"Mean of Ratios"</span><span class="op">)</span>,</span>
<span>         truncation <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">truncation</span>, no <span class="op">=</span> <span class="st">"No truncation"</span>, trunc <span class="op">=</span> <span class="st">"30-min truncation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">estimator</span>, <span class="va">truncation</span>, <span class="va">mean</span>, <span class="va">bias</span>, <span class="va">pct_bias</span>, <span class="va">rmse</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span>, caption <span class="op">=</span> <span class="st">"Roving Design: Estimator Performance"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Roving Design: Estimator Performance
</caption>
<thead><tr class="header">
<th style="text-align: left;">
estimator
</th>
<th style="text-align: left;">
truncation
</th>
<th style="text-align: right;">
mean
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
<th style="text-align: right;">
rmse
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">
Ratio of Means
</td>
<td style="text-align: left;">
No truncation
</td>
<td style="text-align: right;">
1.9957
</td>
<td style="text-align: right;">
-0.0209
</td>
<td style="text-align: right;">
-1.0341
</td>
<td style="text-align: right;">
0.4985
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
Mean of Ratios
</td>
<td style="text-align: left;">
No truncation
</td>
<td style="text-align: right;">
1.9909
</td>
<td style="text-align: right;">
-0.0256
</td>
<td style="text-align: right;">
-1.2698
</td>
<td style="text-align: right;">
0.4629
</td>
</tr>
<tr class="odd">
<td style="text-align: left;">
Ratio of Means
</td>
<td style="text-align: left;">
30-min truncation
</td>
<td style="text-align: right;">
1.9966
</td>
<td style="text-align: right;">
-0.0199
</td>
<td style="text-align: right;">
-0.9880
</td>
<td style="text-align: right;">
0.5041
</td>
</tr>
<tr class="even">
<td style="text-align: left;">
Mean of Ratios
</td>
<td style="text-align: left;">
30-min truncation
</td>
<td style="text-align: right;">
2.0092
</td>
<td style="text-align: right;">
-0.0073
</td>
<td style="text-align: right;">
-0.3629
</td>
<td style="text-align: right;">
0.4400
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Key Findings:</strong>
</p>
<ol type="1">
<li>
<strong>R₁ (ratio-of-means) is BIASED for roving interviews</strong> - does not estimate population catch rate
</li>
<li>
<strong>R₂ (mean-of-ratios) without truncation is approximately unbiased BUT has high variance</strong> (unstable)
</li>
<li>
<strong>R₂ with truncation is approximately unbiased AND has lower variance</strong> ✓ <strong>RECOMMENDED</strong>
</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb27" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roving_mc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span>, <span class="va">r1_no_trunc</span>, <span class="va">r2_no_trunc</span>, <span class="va">r1_with_trunc</span>, <span class="va">r2_with_trunc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rep</span>, <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"estimator"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    estimator_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"r1"</span>, <span class="va">estimator</span><span class="op">)</span>, <span class="st">"Ratio of Means (R₁)"</span>, <span class="st">"Mean of Ratios (R₂)"</span><span class="op">)</span>,</span>
<span>    truncation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"no_trunc"</span>, <span class="va">estimator</span><span class="op">)</span>, <span class="st">"No Truncation"</span>, <span class="st">"30-Min Truncation"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estimate</span>, fill <span class="op">=</span> <span class="va">truncation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.6</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">estimator_type</span> <span class="op">~</span> <span class="va">truncation</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Roving Design: Impact of Estimator Choice and Truncation"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Dashed line = true population catch rate"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Estimated Catch Rate (fish/hour)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Truncation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p>
<img class="img-fluid figure-img" src="ratio-estimators-guide_files/figure-html/roving-plot-1.png" width="768"></p>
<figcaption>
Roving Design: Effect of Truncation. R₁ (ratio-of-means) is biased for roving surveys regardless of truncation. R₂ (mean-of-ratios) is unbiased but has high variance without truncation; truncation reduces variance while maintaining unbiasedness.
</figcaption></figure>
</div>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="practical-implementation-with-tidycreel" id="practical-implementation-with-tidycreel-1">
Practical Implementation with tidycreel
<a class="anchor" aria-label="anchor" href="#practical-implementation-with-tidycreel-1"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-survey-example" id="access-point-survey-example-1">
Access Point Survey Example
<a class="anchor" aria-label="anchor" href="#access-point-survey-example-1"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb28" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have complete-trip interview data</span></span>
<span><span class="va">interviews_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">100</span>, shape <span class="op">=</span> <span class="fl">4</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_interviews</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_complete</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use RATIO-OF-MEANS (default and recommended)</span></span>
<span><span class="va">cpue_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_interviews</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"ratio_of_means"</span>  <span class="co"># ✓ Correct for access interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_access</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-survey-example" id="roving-survey-example-1">
Roving Survey Example
<a class="anchor" aria-label="anchor" href="#roving-survey-example-1"></a>
</h4>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb29" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assuming you have incomplete-trip interview data</span></span>
<span><span class="va">interviews_incomplete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  angler_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  catch_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,  <span class="co"># Catch so far</span></span>
<span>  hours_fished <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span>, min <span class="op">=</span> <span class="fl">0.2</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,  <span class="co"># Time so far</span></span>
<span>  day_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weekday"</span>, <span class="st">"weekend"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORTANT: Truncate short trips before analysis</span></span>
<span><span class="va">interviews_truncated</span> <span class="op">&lt;-</span> <span class="va">interviews_incomplete</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">hours_fished</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Remove trips &lt; 30 minutes</span></span>
<span></span>
<span><span class="co"># Create survey design</span></span>
<span><span class="va">svy_roving</span> <span class="op">&lt;-</span> <span class="fu">survey</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span></span>
<span>  ids <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  strata <span class="op">=</span> <span class="op">~</span><span class="va">day_type</span>,</span>
<span>  data <span class="op">=</span> <span class="va">interviews_truncated</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use MEAN-OF-RATIOS for roving interviews</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="va">svy_roving</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"catch_total"</span>,</span>
<span>  effort_col <span class="op">=</span> <span class="st">"hours_fished"</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span>  <span class="co"># ✓ Correct for roving interviews</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cpue_roving</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="variance-estimation" id="variance-estimation-1">
Variance Estimation
<a class="anchor" aria-label="anchor" href="#variance-estimation-1"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="access-point-ratio-of-means" id="access-point-ratio-of-means-1">
Access Point (Ratio-of-Means)
<a class="anchor" aria-label="anchor" href="#access-point-ratio-of-means-1"></a>
</h4>
<p>
For ratio-of-means with survey weights, the <code>survey</code> package automatically uses the delta method:
</p>
<p>
<strong>Note:</strong> These variance formulas assume sampling from an infinite (or very large) population. If your sample size is substantial relative to the total number of anglers (n/N &gt; 5%), you may want to apply a finite population correction (FPC): multiply the variance by (1 - n/N). However, for most creel surveys where the population of potential anglers is large, this correction is negligible.
</p>
<p>
<span class="math display">[(_1) (C - _1 E)]</span>
</p>
<p>
where <span class="math inline">(C)</span> = catch, <span class="math inline">(E)</span> = effort.
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb30" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># survey::svyratio() provides proper variance</span></span>
<span><span class="va">cpue_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_interviews</span>, mode <span class="op">=</span> <span class="st">"ratio_of_means"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error is included</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">se</span></span>
<span></span>
<span><span class="co"># 95% confidence interval</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_result</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section><section class="level3"><h4 class="anchored" data-anchor-id="roving-mean-of-ratios-with-truncation" id="roving-mean-of-ratios-with-truncation-1">
Roving (Mean-of-Ratios with Truncation)
<a class="anchor" aria-label="anchor" href="#roving-mean-of-ratios-with-truncation-1"></a>
</h4>
<p>
For mean-of-ratios, variance is straightforward:
</p>
<p>
<span class="math display">[(_2) = ()]</span>
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb31" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># survey::svymean() on the ratio variable</span></span>
<span><span class="va">cpue_roving</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_cpue.html">est_cpue</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">svy_roving</span>, mode <span class="op">=</span> <span class="st">"mean_of_ratios"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard error and CIs included</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">se</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_low</span></span>
<span><span class="va">cpue_roving</span><span class="op">$</span><span class="va">ci_high</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
</div>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="special-considerations" id="special-considerations-1">
Special Considerations
<a class="anchor" aria-label="anchor" href="#special-considerations-1"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="bag-limits" id="bag-limits-1">
Bag Limits
<a class="anchor" aria-label="anchor" href="#bag-limits-1"></a>
</h4>
<p>
<strong>⚠️ CRITICAL WARNING:</strong> Roving surveys can produce <strong>severe negative bias</strong> (underestimation of 20-50%+) when bag limits are low (≤5 fish) and anglers comply by leaving immediately upon reaching the limit.
</p>
<p>
<strong>Problem:</strong> If anglers leave immediately after catching their limit, the roving clerk will encounter <strong>only unsuccessful anglers</strong>, leading to severe underestimation.
</p>
<p>
<strong>Example simulation</strong> (bag limit = 2 fish):
</p>
<div class="cell">
<div class="code-copy-outer-scaffold">
<div id="cb32" class="sourceCode cell-code">
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulate_with_bag_limit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_reps</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">bag_limit</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_reps</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rep</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simulate fishing day</span></span>
<span>    <span class="va">day</span> <span class="op">&lt;-</span> <span class="fu">simulate_fishing_day</span><span class="op">(</span>n_anglers <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="va">true_rate</span> <span class="op">&lt;-</span> <span class="va">day</span><span class="op">$</span><span class="va">true_population_rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Apply bag limit: anglers stop when limit reached</span></span>
<span>    <span class="va">day_limited</span> <span class="op">&lt;-</span> <span class="va">day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        <span class="co"># Time to reach bag limit (exponential waiting time)</span></span>
<span>        time_to_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">catch_rate_true</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>                               <span class="va">bag_limit</span> <span class="op">/</span> <span class="va">catch_rate_true</span>,</span>
<span>                               <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual trip length (stop at limit or planned end, whichever comes first)</span></span>
<span>        actual_trip_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">trip_length</span>, <span class="va">time_to_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Actual catch (capped at bag limit)</span></span>
<span>        actual_catch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">completed_catch</span>, <span class="va">bag_limit</span><span class="op">)</span>,</span>
<span>        <span class="co"># Did angler reach bag limit before planned trip end?</span></span>
<span>        reached_limit <span class="op">=</span> <span class="op">(</span><span class="va">time_to_limit</span> <span class="op">&lt;</span> <span class="va">trip_length</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Roving interviews can only encounter anglers still on-site</span></span>
<span>    <span class="co"># Those who reached bag limit before their planned trip end have already left</span></span>
<span>    <span class="co"># Only those who haven't reached the limit OR reached it at/after planned end are available</span></span>
<span>    <span class="va">still_fishing</span> <span class="op">&lt;-</span> <span class="va">day_limited</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">reached_limit</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">still_fishing</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Sample from those still fishing</span></span>
<span>      <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu">sample_roving_interviews</span><span class="op">(</span><span class="va">still_fishing</span>, n_interviews <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="va">catch_at_interview</span>, effort <span class="op">=</span> <span class="va">time_at_interview</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">effort</span> <span class="op">&gt;=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">r2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">catch</span> <span class="op">/</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="va">r2</span>,</span>
<span>                     bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>rep <span class="op">=</span> <span class="va">rep</span>, true_rate <span class="op">=</span> <span class="va">true_rate</span>, estimated_rate <span class="op">=</span> <span class="cn">NA</span>, bag_limit <span class="op">=</span> <span class="va">bag_limit</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bag_limit_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">simulate_with_bag_limit</span><span class="op">(</span>bag_limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op">&lt;-</span> <span class="va">bag_limit_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">bag_limit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    true_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    mean_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span><span class="op">)</span>,</span>
<span>    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span>,</span>
<span>    pct_bias <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimated_rate</span> <span class="op">-</span> <span class="va">true_rate</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_rate</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bag_limit_summary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Roving Bias Under Different Bag Limits"</span><span class="op">)</span></span></code></pre>
</div>
<button class="code-copy-button" title="Copy to Clipboard">
<i class="bi"></i>
</button>
</div>
<div class="cell-output-display">
<table class="table caption-top table table-sm table-striped small">
<caption>
Roving Bias Under Different Bag Limits
</caption>
<thead><tr class="header">
<th style="text-align: right;">
bag_limit
</th>
<th style="text-align: right;">
true_rate
</th>
<th style="text-align: right;">
mean_estimate
</th>
<th style="text-align: right;">
bias
</th>
<th style="text-align: right;">
pct_bias
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">
2
</td>
<td style="text-align: right;">
2.010
</td>
<td style="text-align: right;">
0.341
</td>
<td style="text-align: right;">
-1.668
</td>
<td style="text-align: right;">
-83.017
</td>
</tr>
<tr class="even">
<td style="text-align: right;">
5
</td>
<td style="text-align: right;">
2.001
</td>
<td style="text-align: right;">
0.655
</td>
<td style="text-align: right;">
-1.346
</td>
<td style="text-align: right;">
-67.286
</td>
</tr>
<tr class="odd">
<td style="text-align: right;">
10
</td>
<td style="text-align: right;">
2.003
</td>
<td style="text-align: right;">
1.021
</td>
<td style="text-align: right;">
-0.982
</td>
<td style="text-align: right;">
-49.014
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
<strong>Recommendation:</strong> If bag limits are low (≤5 fish) and compliance is high, <strong>use access point interviews</strong> instead of roving.
</p>
</section><section class="level3"><h4 class="anchored" data-anchor-id="nonstationary-catch-rates" id="nonstationary-catch-rates-1">
Nonstationary Catch Rates
<a class="anchor" aria-label="anchor" href="#nonstationary-catch-rates-1"></a>
</h4>
<p>
If catch rates change systematically during trips (e.g., learning curve, time-of-day effects), roving interviews may be biased.
</p>
<p>
<strong>Check this by:</strong>
</p>
<ol type="1">
<li>
Comparing incomplete-trip catch rates to complete-trip catch rates
</li>
<li>
Looking for patterns in catch rate vs. time-of-day
</li>
</ol>
<p>
<strong>If nonstationary:</strong> Consider access point interviews or model the time-varying catch rate.
</p>
</section></section><section class="section level3"><h3 class="anchored" data-anchor-id="summary-practical-guidelines" id="summary-practical-guidelines-1">
Summary: Practical Guidelines
<a class="anchor" aria-label="anchor" href="#summary-practical-guidelines-1"></a>
</h3>
<section class="level3"><h4 class="anchored" data-anchor-id="decision-rules" id="decision-rules-1">
Decision Rules
<a class="anchor" aria-label="anchor" href="#decision-rules-1"></a>
</h4>
<table class="table caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 24%">
<col style="width: 33%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>
Survey Type
</th>
<th>
Interview Type
</th>
<th>
Recommended Estimator
</th>
<th>
Function Call
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
Access point
</td>
<td>
Complete trips
</td>
<td>
Ratio-of-means (R₁)
</td>
<td>
<code>est_cpue(…, mode = “ratio_of_means”)</code>
</td>
</tr>
<tr class="even">
<td>
Roving
</td>
<td>
Incomplete trips
</td>
<td>
Mean-of-ratios (R₂) with truncation
</td>
<td>
<code>est_cpue(…, mode = “mean_of_ratios”)</code> + filter short trips
</td>
</tr>
<tr class="odd">
<td>
Complemented (aerial-access)
</td>
<td>
Complete trips
</td>
<td>
Ratio-of-means (R₁)
</td>
<td>
<code>est_cpue(…, mode = “ratio_of_means”)</code>
</td>
</tr>
<tr class="even">
<td>
Complemented (aerial-roving)
</td>
<td>
Incomplete trips
</td>
<td>
Mean-of-ratios (R₂) with truncation
</td>
<td>
<code>est_cpue(…, mode = “mean_of_ratios”)</code> + filter
</td>
</tr>
</tbody>
</table></section><section class="level3"><h4 class="anchored" data-anchor-id="pre-processing-checklist" id="pre-processing-checklist-1">
Pre-processing Checklist
<a class="anchor" aria-label="anchor" href="#pre-processing-checklist-1"></a>
</h4>
<p>
<strong>For ALL surveys:</strong>
</p>
<ul class="task-list">
<li>
<label><input type="checkbox">Check for missing data in catch and effort</label>
</li>
<li>
<label><input type="checkbox">Verify effort &gt; 0 for all interviews</label>
</li>
<li>
<label><input type="checkbox">Check for outliers (data entry errors)</label>
</li>
</ul>
<p>
<strong>For ROVING surveys specifically:</strong>
</p>
<ul class="task-list">
<li>
<label><input type="checkbox">Truncate short trips (&lt; 20-30 minutes)</label>
</li>
<li>
<label><input type="checkbox">Check bag limit compliance (may cause bias)</label>
</li>
<li>
<label><input type="checkbox">Verify catch rate stationarity (if possible)</label>
</li>
</ul></section><section class="level3"><h4 class="anchored" data-anchor-id="variance-estimation-checklist" id="variance-estimation-checklist-1">
Variance Estimation Checklist
<a class="anchor" aria-label="anchor" href="#variance-estimation-checklist-1"></a>
</h4>
<ul class="task-list">
<li>
<label><input type="checkbox">Use proper survey weights in <code><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign()</a></code></label>
</li>
<li>
<label><input type="checkbox">Include stratification variables</label>
</li>
<li>
<label><input type="checkbox">Use <code><a href="https://rdrr.io/pkg/survey/man/svyratio.html" class="external-link">svyratio()</a></code> for ratio-of-means</label>
</li>
<li>
<label><input type="checkbox">Use <code><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean()</a></code> on catch/effort ratio for mean-of-ratios</label>
</li>
<li>
<label><input type="checkbox">Report standard errors and confidence intervals</label>
</li>
</ul></section></section><section class="section level3"><h3 class="anchored" data-anchor-id="references" id="references-1">
References
<a class="anchor" aria-label="anchor" href="#references-1"></a>
</h3>
<ul>
<li>
<p>
<strong>Pollock, K.H., Hoenig, J.M., Jones, C.M., Robson, D.S., &amp; Greene, C.J. (1997).</strong> Catch rate estimation for roving and access point surveys. <em>North American Journal of Fisheries Management</em>, 17(1), 11-19.
</p>
</li>
<li>
<p>
<strong>Rasmussen, P.W., Staggs, M.D., Beard, T.D., &amp; Newman, S.P. (1998).</strong> Bias and confidence interval coverage of creel survey estimators evaluated by simulation. <em>Transactions of the American Fisheries Society</em>, 127(3), 469-480.
</p>
</li>
<li>
<p>
<strong>Jones, C.M., Robson, D.S., Lakkis, H.D., &amp; Kressel, J. (1995).</strong> Properties of catch rates used in analysis of angler surveys. <em>Transactions of the American Fisheries Society</em>, 124(6), 911-928.
</p>
</li>
<li>
<p>
<strong>Lumley, T. (2004).</strong> Analysis of complex survey samples. <em>Journal of Statistical Software</em>, 9(1), 1-19.
</p>
</li>
</ul></section><section class="section level3"><h3 class="anchored" data-anchor-id="conclusion" id="conclusion-1">
Conclusion
<a class="anchor" aria-label="anchor" href="#conclusion-1"></a>
</h3>
<p>
The choice between ratio-of-means and mean-of-ratios depends fundamentally on your <strong>survey design</strong>:
</p>
<ul>
<li>
<strong>Access point interviews</strong> → Use <strong>ratio-of-means</strong>
</li>
<li>
<strong>Roving interviews</strong> → Use <strong>mean-of-ratios with truncation</strong>
</li>
</ul>
<p>
The <code>tidycreel</code> package implements both estimators with proper variance estimation through the <code>survey</code> package. By following the decision rules in this vignette, you can ensure your catch rate estimates are unbiased and your confidence intervals have correct coverage.
</p>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christopher Chizinski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
