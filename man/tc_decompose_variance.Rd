% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/variance-decomposition-engine.R
\name{tc_decompose_variance}
\alias{tc_decompose_variance}
\title{Decompose Variance into Components}
\usage{
tc_decompose_variance(
  design,
  response,
  cluster_vars = c("stratum"),
  method = "anova",
  conf_level = 0.95
)
}
\arguments{
\item{design}{Survey design object}

\item{response}{Response variable (formula or character)}

\item{cluster_vars}{Character vector of clustering variables in order of nesting
(e.g., c("stratum", "day", "shift"))}

\item{method}{Decomposition method:
\describe{
\item{"anova"}{ANOVA-based decomposition (default)}
\item{"mixed_model"}{Mixed model variance components}
\item{"survey_weighted"}{Survey-weighted decomposition}
}}

\item{conf_level}{Confidence level for component intervals (default 0.95)}
}
\value{
List with class "tc_variance_decomp" containing:
\describe{
\item{components}{Data frame of variance components}
\item{proportions}{Proportion of total variance by component}
\item{intraclass_correlations}{ICC values}
\item{design_effects}{Design effects by component}
\item{optimal_allocation}{Recommended sample allocation}
\item{variance_ratios}{Ratios for sample size planning}
\item{method}{Decomposition method used}
}
}
\description{
Decomposes total variance into component sources for creel survey estimates.
Built-in to tidycreel estimators through the \code{decompose_variance} parameter.
}
\details{
\subsection{Variance Component Model}{

For nested creel survey structure:
\deqn{Y_{ijkl} = \mu + \alpha_i + \beta_{j(i)} + \gamma_{k(ij)} + \epsilon_{l(ijk)}}

Where:
\itemize{
\item \eqn{\alpha_i} = stratum effect (among-stratum variance)
\item \eqn{\beta_{j(i)}} = day effect within stratum (among-day variance)
\item \eqn{\gamma_{k(ij)}} = shift effect within day (among-shift variance)
\item \eqn{\epsilon_{l(ijk)}} = residual (within-shift variance)
}
}

\subsection{Key Applications}{
\itemize{
\item \strong{Optimal Allocation}: Determine optimal days vs counts per day
\item \strong{Design Effects}: Quantify clustering impact
\item \strong{Sample Size Planning}: Use variance ratios for power analysis
\item \strong{Efficiency Analysis}: Identify largest variance sources
}
}
}
\examples{
\dontrun{
# Decompose variance for effort estimate
decomp <- tc_decompose_variance(
  design = creel_design,
  response = "effort_hours",
  cluster_vars = c("stratum", "day")
)

# View components
print(decomp)
decomp$components
decomp$proportions

# Optimal allocation recommendations
decomp$optimal_allocation
}

}
