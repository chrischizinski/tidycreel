% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est-effort-aerial.R
\name{est_effort.aerial}
\alias{est_effort.aerial}
\title{Aerial Effort Estimator (REBUILT with Native Survey Integration)}
\usage{
est_effort.aerial(
  counts,
  by = c("date", "location"),
  minutes_col = c("flight_minutes", "interval_minutes", "count_duration"),
  total_minutes_col = c("total_minutes", "total_day_minutes", "block_total_minutes"),
  day_id = "date",
  covariates = NULL,
  visibility_col = NULL,
  calibration_col = NULL,
  svy = NULL,
  post_strata_var = NULL,
  post_strata = NULL,
  calibrate_formula = NULL,
  calibrate_population = NULL,
  calfun = c("linear", "raking", "logit"),
  conf_level = 0.95,
  variance_method = "survey",
  decompose_variance = FALSE,
  design_diagnostics = FALSE,
  n_replicates = 1000
)
}
\arguments{
\item{counts}{Data frame/tibble of aerial counts with at least \code{count} and a
minutes column (e.g., \code{flight_minutes}, \code{interval_minutes}, or \code{count_duration}).}

\item{by}{Character vector of grouping variables present in \code{counts}
(e.g., \code{date}, \code{location}). Missing columns are ignored with a warning.}

\item{minutes_col}{Candidate column names for minutes represented by each
count. The first present is used.}

\item{total_minutes_col}{Optional column giving the total minutes represented
for the whole day×group (e.g., full day length or block coverage). If
absent, the estimator falls back to the sum of per-count minutes within the
day×group (warns).}

\item{day_id}{Day identifier (PSU), typically \code{date}, used to join to the
survey design.}

\item{covariates}{Optional character vector of additional grouping variables
for aerial conditions (e.g., \code{cloud}, \code{glare}, \code{observer}, \code{altitude}).}

\item{visibility_col}{Optional name of a column with visibility proportion
(0–1). Counts are divided by this value (guarded to avoid division by very
small numbers).}

\item{calibration_col}{Optional name of a column with multiplicative
calibration factors to apply after visibility correction.}

\item{svy}{Optional \code{svydesign}/\code{svrepdesign} encoding the day sampling
design (must include \code{day_id} in \code{svy$variables}). When provided, totals,
SEs, and CIs are computed with \code{survey} functions.}

\item{post_strata_var}{Optional post-stratification variable name}

\item{post_strata}{Optional post-stratification population table}

\item{calibrate_formula}{Optional calibration formula}

\item{calibrate_population}{Optional calibration population totals}

\item{calfun}{Calibration function: "linear", "raking", or "logit"}

\item{conf_level}{Confidence level for Wald CIs (default 0.95).}

\item{variance_method}{\strong{NEW} Variance estimation method (default "survey")}

\item{decompose_variance}{\strong{NEW} Logical, decompose variance (default FALSE)}

\item{design_diagnostics}{\strong{NEW} Logical, compute diagnostics (default FALSE)}

\item{n_replicates}{\strong{NEW} Bootstrap/jackknife replicates (default 1000)}
}
\value{
Tibble with grouping columns plus:
\describe{
\item{estimate}{Estimated total effort (angler-hours)}
\item{se}{Standard error}
\item{ci_low, ci_high}{Confidence interval limits}
\item{deff}{Design effect}
\item{n}{Sample size}
\item{method}{Estimation method ("aerial")}
\item{variance_info}{\strong{NEW} List-column with comprehensive variance information}
}
}
\description{
Estimate angler-hours from aerial snapshot counts using a mean-count
expansion within groups, with optional visibility and calibration
adjustments, and design-based variance via the \code{survey} package with
NATIVE support for advanced variance methods.
}
\details{
\strong{NEW}: Native support for multiple variance methods, variance decomposition,
and design diagnostics without requiring wrapper functions.
}
\examples{
\dontrun{
# BACKWARD COMPATIBLE
result <- est_effort.aerial_rebuilt(counts, svy = design)

# NEW: Complete analysis
result_full <- est_effort.aerial_rebuilt(
  counts,
  svy = design,
  variance_method = "bootstrap",
  decompose_variance = TRUE,
  design_diagnostics = TRUE
)
}

}
