% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/est-total-harvest.R
\name{est_total_harvest}
\alias{est_total_harvest}
\title{Estimate Total Harvest/Catch Using Product Estimator (REBUILT)}
\usage{
est_total_harvest(
  effort_est,
  cpue_est,
  by = NULL,
  response = c("catch_total", "catch_kept", "catch_released"),
  method = c("product", "separate_ratio"),
  correlation = NULL,
  conf_level = 0.95,
  diagnostics = TRUE
)
}
\arguments{
\item{effort_est}{Tibble from \code{est_effort()} with effort estimates}

\item{cpue_est}{Tibble from \code{est_cpue()} or \code{aggregate_cpue()} with CPUE estimates}

\item{by}{Character vector of grouping variables (must match between inputs).}

\item{response}{Type of catch: \code{"catch_total"}, \code{"catch_kept"}, or \code{"catch_released"}.}

\item{method}{Estimation method: \code{"product"} (default) or \code{"separate_ratio"}.}

\item{correlation}{Correlation between effort and CPUE estimates (default \code{NULL}):
\itemize{
\item \code{NULL}: Independent (conservative)
\item Numeric (-1 to 1): Specified correlation
\item \code{"auto"}: Estimate from data (not implemented)
}}

\item{conf_level}{Confidence level for Wald CIs (default 0.95)}

\item{diagnostics}{Include diagnostic information (default \code{TRUE})}
}
\value{
Tibble with grouping columns, \code{estimate}, \code{se}, \code{ci_low}, \code{ci_high},
\code{deff} (design effect propagated from inputs), \code{n}, \code{method}, \code{diagnostics}
list-column, and \code{variance_info} list-column.
}
\description{
Estimates total harvest, catch, or releases by multiplying effort and CPUE
estimates with proper variance propagation using the delta method.
}
\details{
\strong{REBUILT}: Enhanced output structure with design effects and comprehensive
variance information, matching the native survey integration architecture.
\subsection{Statistical Method}{

Combines effort (E) and CPUE (C): H = E × C
}

\subsection{Variance Propagation (Delta Method)}{

Independent (default): Var(H) = E² × Var(C) + C² × Var(E)
Correlated: Var(H) = E² × Var(C) + C² × Var(E) + 2 × E × C × Cov(E,C)
}

\subsection{Species Aggregation}{

Use \code{aggregate_cpue()} BEFORE this function for proper variance:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{# CORRECT
cpue_black_bass <- aggregate_cpue(interviews, svy_int,
  species_values = c("largemouth_bass", "smallmouth_bass"),
  group_name = "black_bass")
harvest <- est_total_harvest(effort_est, cpue_black_bass)

# WRONG (ignores covariance)
harvest <- sum(est_total_harvest(effort, cpue_lmb)$estimate,
               est_total_harvest(effort, cpue_smb)$estimate)
}\if{html}{\out{</div>}}
}
}
\examples{
\dontrun{
# BACKWARD COMPATIBLE
harvest <- est_total_harvest(effort_est, cpue_est)

# NEW: Enhanced output with deff and variance_info
harvest <- est_total_harvest(effort_est, cpue_est)
harvest$deff  # Design effect propagated from inputs
harvest$variance_info[[1]]  # Delta method details
}

}
\references{
Pollock, K.H., C.M. Jones, and T.L. Brown. 1994. Angler Survey Methods.
American Fisheries Society Special Publication 25.
}
\seealso{
\code{\link[=est_effort]{est_effort()}}, \code{\link[=est_cpue]{est_cpue()}}, \code{\link[=aggregate_cpue]{aggregate_cpue()}}
}
