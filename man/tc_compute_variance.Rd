% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/variance-engine.R
\name{tc_compute_variance}
\alias{tc_compute_variance}
\title{Compute Variance Using Survey Package Methods}
\usage{
tc_compute_variance(
  design,
  response,
  method = "survey",
  by = NULL,
  conf_level = 0.95,
  n_replicates = 1000,
  calculate_deff = TRUE
)
}
\arguments{
\item{design}{Survey design object (svydesign or svrepdesign)}

\item{response}{Response variable (formula or character)}

\item{method}{Variance estimation method:
\describe{
\item{"survey"}{Standard survey package variance (default)}
\item{"svyrecvar"}{survey:::svyrecvar internals (most accurate)}
\item{"bootstrap"}{Bootstrap resampling variance}
\item{"jackknife"}{Jackknife resampling variance}
\item{"linearization"}{Taylor linearization (same as "survey")}
}}

\item{by}{Optional grouping variables for stratified estimation}

\item{conf_level}{Confidence level for intervals (default 0.95)}

\item{n_replicates}{Number of replicates for bootstrap/jackknife (default 1000)}

\item{calculate_deff}{Whether to calculate design effects (default TRUE)}
}
\value{
List with variance estimation results:
\describe{
\item{estimate}{Point estimate(s)}
\item{variance}{Variance estimate(s)}
\item{se}{Standard error(s)}
\item{ci_lower}{Lower confidence limit(s)}
\item{ci_upper}{Upper confidence limit(s)}
\item{deff}{Design effect(s) (if calculate_deff = TRUE)}
\item{method}{Variance method used}
\item{method_details}{Additional method-specific information}
\item{conf_level}{Confidence level used}
}
}
\description{
Core variance calculation engine that ALL tidycreel estimators use.
Provides unified interface to multiple variance estimation methods.
}
\details{
This is the core variance calculation function used by ALL tidycreel estimators.
It provides a unified interface to multiple variance estimation approaches:

\strong{Standard Methods:}
\itemize{
\item \code{"survey"}: Uses survey package public API (svymean, svytotal, svyby)
\item \code{"linearization"}: Alias for "survey" (Taylor linearization is the default)
}

\strong{Survey Package Internals:}
\itemize{
\item \code{"svyrecvar"}: Direct access to survey:::svyrecvar for maximum accuracy
}

\strong{Resampling Methods:}
\itemize{
\item \code{"bootstrap"}: Bootstrap variance estimation with replicate weights
\item \code{"jackknife"}: Jackknife variance estimation
}

\strong{Design Effects:}
When \code{calculate_deff = TRUE}, the function computes design effects (DEFF)
which measure the impact of the survey design on variance compared to
simple random sampling. DEFF values > 1 indicate design effects from
clustering, stratification, or weighting.
}
\examples{
\dontrun{
library(survey)
library(tidycreel)

# Create survey design
design <- svydesign(ids = ~1, data = creel_counts, weights = ~1)

# Standard variance
var_result <- tc_compute_variance(design, "anglers_count")

# Bootstrap variance
var_boot <- tc_compute_variance(
  design,
  "anglers_count",
  method = "bootstrap",
  n_replicates = 2000
)

# Survey internals (most accurate)
var_internals <- tc_compute_variance(
  design,
  "anglers_count",
  method = "svyrecvar"
)

# Grouped estimation
var_by_strata <- tc_compute_variance(
  design,
  "anglers_count",
  by = "stratum"
)
}

}
\keyword{internal}
